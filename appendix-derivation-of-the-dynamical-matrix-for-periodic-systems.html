<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>A Appendix: Derivation of the dynamical matrix for periodic systems | Neutrons for Sustainable Energy Lecture Notes</title>
  <meta name="description" content="These are notes to accompany the Computaional Tools lectures for the 2025 Neutrons for Sustainable Energy training school." />
  <meta name="generator" content="bookdown 0.46 and GitBook 2.6.7" />

  <meta property="og:title" content="A Appendix: Derivation of the dynamical matrix for periodic systems | Neutrons for Sustainable Energy Lecture Notes" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="These are notes to accompany the Computaional Tools lectures for the 2025 Neutrons for Sustainable Energy training school." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="A Appendix: Derivation of the dynamical matrix for periodic systems | Neutrons for Sustainable Energy Lecture Notes" />
  
  <meta name="twitter:description" content="These are notes to accompany the Computaional Tools lectures for the 2025 Neutrons for Sustainable Energy training school." />
  

<meta name="author" content="Benjamin J. Morgan" />


<meta name="date" content="2025-12-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="wrap-up.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>



<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Neutrons for Sustainable Energy</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#shared-observables"><i class="fa fa-check"></i>Shared observables</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#scope"><i class="fa fa-check"></i>Scope</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#energy-materials"><i class="fa fa-check"></i>Energy materials</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#learning-objectives"><i class="fa fa-check"></i>Learning objectives</a></li>
</ul></li>
<li class="part"><span><b>I Methods for E(r)</b></span></li>
<li class="chapter" data-level="1" data-path="the-potential-energy-surface.html"><a href="the-potential-energy-surface.html"><i class="fa fa-check"></i><b>1</b> The potential energy surface</a>
<ul>
<li class="chapter" data-level="1.1" data-path="the-potential-energy-surface.html"><a href="the-potential-energy-surface.html#building-the-concept"><i class="fa fa-check"></i><b>1.1</b> Building the concept</a></li>
<li class="chapter" data-level="1.2" data-path="the-potential-energy-surface.html"><a href="the-potential-energy-surface.html#features-of-the-pes"><i class="fa fa-check"></i><b>1.2</b> Features of the PES</a></li>
<li class="chapter" data-level="1.3" data-path="the-potential-energy-surface.html"><a href="the-potential-energy-surface.html#two-questions"><i class="fa fa-check"></i><b>1.3</b> Two questions</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="classical-potentials.html"><a href="classical-potentials.html"><i class="fa fa-check"></i><b>2</b> Classical potentials</a>
<ul>
<li class="chapter" data-level="2.1" data-path="classical-potentials.html"><a href="classical-potentials.html#why-start-here"><i class="fa fa-check"></i><b>2.1</b> Why start here?</a></li>
<li class="chapter" data-level="2.2" data-path="classical-potentials.html"><a href="classical-potentials.html#the-simplest-model-pair-potentials"><i class="fa fa-check"></i><b>2.2</b> The simplest model: pair potentials</a></li>
<li class="chapter" data-level="2.3" data-path="classical-potentials.html"><a href="classical-potentials.html#building-a-potential-from-physics"><i class="fa fa-check"></i><b>2.3</b> Building a potential from physics</a></li>
<li class="chapter" data-level="2.4" data-path="classical-potentials.html"><a href="classical-potentials.html#periodic-systems-and-the-ewald-problem"><i class="fa fa-check"></i><b>2.4</b> Periodic systems and the Ewald problem</a></li>
<li class="chapter" data-level="2.5" data-path="classical-potentials.html"><a href="classical-potentials.html#when-pair-potentials-arent-enough"><i class="fa fa-check"></i><b>2.5</b> When pair potentials aren’t enough</a></li>
<li class="chapter" data-level="2.6" data-path="classical-potentials.html"><a href="classical-potentials.html#the-parameterisation-problem"><i class="fa fa-check"></i><b>2.6</b> The parameterisation problem</a></li>
<li class="chapter" data-level="2.7" data-path="classical-potentials.html"><a href="classical-potentials.html#strengths-and-limitations"><i class="fa fa-check"></i><b>2.7</b> Strengths and limitations</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="density-functional-theory.html"><a href="density-functional-theory.html"><i class="fa fa-check"></i><b>3</b> Density functional theory</a>
<ul>
<li class="chapter" data-level="3.1" data-path="density-functional-theory.html"><a href="density-functional-theory.html#why-first-principles"><i class="fa fa-check"></i><b>3.1</b> Why first principles?</a></li>
<li class="chapter" data-level="3.2" data-path="density-functional-theory.html"><a href="density-functional-theory.html#the-problem-the-many-electron-wavefunction"><i class="fa fa-check"></i><b>3.2</b> The problem: the many-electron wavefunction</a></li>
<li class="chapter" data-level="3.3" data-path="density-functional-theory.html"><a href="density-functional-theory.html#the-dft-insight"><i class="fa fa-check"></i><b>3.3</b> The DFT insight</a></li>
<li class="chapter" data-level="3.4" data-path="density-functional-theory.html"><a href="density-functional-theory.html#the-kohn-sham-approach"><i class="fa fa-check"></i><b>3.4</b> The Kohn-Sham approach</a></li>
<li class="chapter" data-level="3.5" data-path="density-functional-theory.html"><a href="density-functional-theory.html#the-kohn-sham-equations"><i class="fa fa-check"></i><b>3.5</b> The Kohn-Sham equations</a></li>
<li class="chapter" data-level="3.6" data-path="density-functional-theory.html"><a href="density-functional-theory.html#still-exactin-principle"><i class="fa fa-check"></i><b>3.6</b> Still exact—in principle</a></li>
<li class="chapter" data-level="3.7" data-path="density-functional-theory.html"><a href="density-functional-theory.html#exchange-correlation-functionals"><i class="fa fa-check"></i><b>3.7</b> Exchange-correlation functionals</a></li>
<li class="chapter" data-level="3.8" data-path="density-functional-theory.html"><a href="density-functional-theory.html#strengths-and-limitations-1"><i class="fa fa-check"></i><b>3.8</b> Strengths and limitations</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="machine-learned-interatomic-potentials.html"><a href="machine-learned-interatomic-potentials.html"><i class="fa fa-check"></i><b>4</b> Machine-learned interatomic potentials</a>
<ul>
<li class="chapter" data-level="4.1" data-path="machine-learned-interatomic-potentials.html"><a href="machine-learned-interatomic-potentials.html#motivation"><i class="fa fa-check"></i><b>4.1</b> Motivation</a></li>
<li class="chapter" data-level="4.2" data-path="machine-learned-interatomic-potentials.html"><a href="machine-learned-interatomic-potentials.html#the-idea"><i class="fa fa-check"></i><b>4.2</b> The idea</a></li>
<li class="chapter" data-level="4.3" data-path="machine-learned-interatomic-potentials.html"><a href="machine-learned-interatomic-potentials.html#local-atomic-environments"><i class="fa fa-check"></i><b>4.3</b> Local atomic environments</a></li>
<li class="chapter" data-level="4.4" data-path="machine-learned-interatomic-potentials.html"><a href="machine-learned-interatomic-potentials.html#the-landscape"><i class="fa fa-check"></i><b>4.4</b> The landscape</a></li>
<li class="chapter" data-level="4.5" data-path="machine-learned-interatomic-potentials.html"><a href="machine-learned-interatomic-potentials.html#strengths-and-limitations-2"><i class="fa fa-check"></i><b>4.5</b> Strengths and limitations</a></li>
<li class="chapter" data-level="4.6" data-path="machine-learned-interatomic-potentials.html"><a href="machine-learned-interatomic-potentials.html#when-to-use"><i class="fa fa-check"></i><b>4.6</b> When to use</a></li>
<li class="chapter" data-level="4.7" data-path="machine-learned-interatomic-potentials.html"><a href="machine-learned-interatomic-potentials.html#summary-and-what-comes-next"><i class="fa fa-check"></i><b>4.7</b> Summary and what comes next</a></li>
</ul></li>
<li class="part"><span><b>II Lattice Dynamics and Molecular Dynamics</b></span></li>
<li class="chapter" data-level="5" data-path="introduction-1.html"><a href="introduction-1.html"><i class="fa fa-check"></i><b>5</b> Introduction</a></li>
<li class="chapter" data-level="6" data-path="finding-minima-geometry-optimisation.html"><a href="finding-minima-geometry-optimisation.html"><i class="fa fa-check"></i><b>6</b> Finding minima: geometry optimisation</a>
<ul>
<li class="chapter" data-level="6.1" data-path="finding-minima-geometry-optimisation.html"><a href="finding-minima-geometry-optimisation.html#why-compute-a-structure"><i class="fa fa-check"></i><b>6.1</b> Why compute a structure?</a></li>
<li class="chapter" data-level="6.2" data-path="finding-minima-geometry-optimisation.html"><a href="finding-minima-geometry-optimisation.html#structures-and-minima"><i class="fa fa-check"></i><b>6.2</b> Structures and minima</a></li>
<li class="chapter" data-level="6.3" data-path="finding-minima-geometry-optimisation.html"><a href="finding-minima-geometry-optimisation.html#steepest-descent"><i class="fa fa-check"></i><b>6.3</b> Steepest descent</a></li>
<li class="chapter" data-level="6.4" data-path="finding-minima-geometry-optimisation.html"><a href="finding-minima-geometry-optimisation.html#doing-better-with-curvature"><i class="fa fa-check"></i><b>6.4</b> Doing better with curvature</a></li>
<li class="chapter" data-level="6.5" data-path="finding-minima-geometry-optimisation.html"><a href="finding-minima-geometry-optimisation.html#local-and-global-minima"><i class="fa fa-check"></i><b>6.5</b> Local and global minima</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="phonon-calculations.html"><a href="phonon-calculations.html"><i class="fa fa-check"></i><b>7</b> Phonon calculations</a>
<ul>
<li class="chapter" data-level="7.1" data-path="phonon-calculations.html"><a href="phonon-calculations.html#vibrations-around-equilibrium"><i class="fa fa-check"></i><b>7.1</b> Vibrations around equilibrium</a></li>
<li class="chapter" data-level="7.2" data-path="phonon-calculations.html"><a href="phonon-calculations.html#the-harmonic-approximation"><i class="fa fa-check"></i><b>7.2</b> The harmonic approximation</a></li>
<li class="chapter" data-level="7.3" data-path="phonon-calculations.html"><a href="phonon-calculations.html#periodic-systems-and-phonon-dispersion"><i class="fa fa-check"></i><b>7.3</b> Periodic systems and phonon dispersion</a></li>
<li class="chapter" data-level="7.4" data-path="phonon-calculations.html"><a href="phonon-calculations.html#calculating-phonons-in-practice"><i class="fa fa-check"></i><b>7.4</b> Calculating phonons in practice</a></li>
<li class="chapter" data-level="7.5" data-path="phonon-calculations.html"><a href="phonon-calculations.html#what-you-get"><i class="fa fa-check"></i><b>7.5</b> What you get</a></li>
<li class="chapter" data-level="7.6" data-path="phonon-calculations.html"><a href="phonon-calculations.html#limitations"><i class="fa fa-check"></i><b>7.6</b> Limitations</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="molecular-dynamics-principles.html"><a href="molecular-dynamics-principles.html"><i class="fa fa-check"></i><b>8</b> Molecular dynamics: principles</a>
<ul>
<li class="chapter" data-level="8.1" data-path="molecular-dynamics-principles.html"><a href="molecular-dynamics-principles.html#from-local-curvature-to-global-exploration"><i class="fa fa-check"></i><b>8.1</b> From local curvature to global exploration</a></li>
<li class="chapter" data-level="8.2" data-path="molecular-dynamics-principles.html"><a href="molecular-dynamics-principles.html#equations-of-motion"><i class="fa fa-check"></i><b>8.2</b> Equations of motion</a></li>
<li class="chapter" data-level="8.3" data-path="molecular-dynamics-principles.html"><a href="molecular-dynamics-principles.html#numerical-integration"><i class="fa fa-check"></i><b>8.3</b> Numerical integration</a></li>
<li class="chapter" data-level="8.4" data-path="molecular-dynamics-principles.html"><a href="molecular-dynamics-principles.html#phase-space-and-trajectories"><i class="fa fa-check"></i><b>8.4</b> Phase space and trajectories</a></li>
<li class="chapter" data-level="8.5" data-path="molecular-dynamics-principles.html"><a href="molecular-dynamics-principles.html#ensembles-and-what-they-mean"><i class="fa fa-check"></i><b>8.5</b> Ensembles and what they mean</a></li>
<li class="chapter" data-level="8.6" data-path="molecular-dynamics-principles.html"><a href="molecular-dynamics-principles.html#thermostats-and-barostats"><i class="fa fa-check"></i><b>8.6</b> Thermostats and barostats</a></li>
<li class="chapter" data-level="8.7" data-path="molecular-dynamics-principles.html"><a href="molecular-dynamics-principles.html#what-you-get-1"><i class="fa fa-check"></i><b>8.7</b> What you get</a></li>
<li class="chapter" data-level="8.8" data-path="molecular-dynamics-principles.html"><a href="molecular-dynamics-principles.html#the-er-choice"><i class="fa fa-check"></i><b>8.8</b> The E(r) choice</a></li>
</ul></li>
<li class="part"><span><b>III Configurational Disorder</b></span></li>
<li class="chapter" data-level="9" data-path="introduction-2.html"><a href="introduction-2.html"><i class="fa fa-check"></i><b>9</b> Introduction</a></li>
<li class="chapter" data-level="10" data-path="monte-carlo-sampling.html"><a href="monte-carlo-sampling.html"><i class="fa fa-check"></i><b>10</b> Monte Carlo sampling</a>
<ul>
<li class="chapter" data-level="10.1" data-path="monte-carlo-sampling.html"><a href="monte-carlo-sampling.html#the-goal-ensemble-averages"><i class="fa fa-check"></i><b>10.1</b> The goal: ensemble averages</a></li>
<li class="chapter" data-level="10.2" data-path="monte-carlo-sampling.html"><a href="monte-carlo-sampling.html#why-not-sample-uniformly"><i class="fa fa-check"></i><b>10.2</b> Why not sample uniformly?</a></li>
<li class="chapter" data-level="10.3" data-path="monte-carlo-sampling.html"><a href="monte-carlo-sampling.html#markov-chain-monte-carlo"><i class="fa fa-check"></i><b>10.3</b> Markov chain Monte Carlo</a></li>
<li class="chapter" data-level="10.4" data-path="monte-carlo-sampling.html"><a href="monte-carlo-sampling.html#the-metropolis-algorithm"><i class="fa fa-check"></i><b>10.4</b> The Metropolis algorithm</a></li>
<li class="chapter" data-level="10.5" data-path="monte-carlo-sampling.html"><a href="monte-carlo-sampling.html#what-you-get-2"><i class="fa fa-check"></i><b>10.5</b> What you get</a></li>
<li class="chapter" data-level="10.6" data-path="monte-carlo-sampling.html"><a href="monte-carlo-sampling.html#what-you-dont-get"><i class="fa fa-check"></i><b>10.6</b> What you don’t get</a></li>
<li class="chapter" data-level="10.7" data-path="monte-carlo-sampling.html"><a href="monte-carlo-sampling.html#mc-for-configurational-disorder"><i class="fa fa-check"></i><b>10.7</b> MC for configurational disorder</a></li>
<li class="chapter" data-level="10.8" data-path="monte-carlo-sampling.html"><a href="monte-carlo-sampling.html#neutron-connection"><i class="fa fa-check"></i><b>10.8</b> Neutron connection</a></li>
<li class="chapter" data-level="10.9" data-path="monte-carlo-sampling.html"><a href="monte-carlo-sampling.html#the-er-cost"><i class="fa fa-check"></i><b>10.9</b> The E(r) cost</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="cluster-expansion.html"><a href="cluster-expansion.html"><i class="fa fa-check"></i><b>11</b> Cluster expansion</a>
<ul>
<li class="chapter" data-level="11.1" data-path="cluster-expansion.html"><a href="cluster-expansion.html#the-problem"><i class="fa fa-check"></i><b>11.1</b> The problem</a></li>
<li class="chapter" data-level="11.2" data-path="cluster-expansion.html"><a href="cluster-expansion.html#the-idea-1"><i class="fa fa-check"></i><b>11.2</b> The idea</a></li>
<li class="chapter" data-level="11.3" data-path="cluster-expansion.html"><a href="cluster-expansion.html#symmetry-and-cluster-types"><i class="fa fa-check"></i><b>11.3</b> Symmetry and cluster types</a></li>
<li class="chapter" data-level="11.4" data-path="cluster-expansion.html"><a href="cluster-expansion.html#fitting-the-expansion"><i class="fa fa-check"></i><b>11.4</b> Fitting the expansion</a></li>
<li class="chapter" data-level="11.5" data-path="cluster-expansion.html"><a href="cluster-expansion.html#what-you-get-3"><i class="fa fa-check"></i><b>11.5</b> What you get</a></li>
<li class="chapter" data-level="11.6" data-path="cluster-expansion.html"><a href="cluster-expansion.html#limitations-1"><i class="fa fa-check"></i><b>11.6</b> Limitations</a></li>
<li class="chapter" data-level="11.7" data-path="cluster-expansion.html"><a href="cluster-expansion.html#connection-to-other-methods"><i class="fa fa-check"></i><b>11.7</b> Connection to other methods</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="short-range-order-and-pdf.html"><a href="short-range-order-and-pdf.html"><i class="fa fa-check"></i><b>12</b> Short-range order and PDF</a>
<ul>
<li class="chapter" data-level="12.1" data-path="short-range-order-and-pdf.html"><a href="short-range-order-and-pdf.html#long-range-order-vs-short-range-order"><i class="fa fa-check"></i><b>12.1</b> Long-range order vs short-range order</a></li>
<li class="chapter" data-level="12.2" data-path="short-range-order-and-pdf.html"><a href="short-range-order-and-pdf.html#what-bragg-diffraction-misses"><i class="fa fa-check"></i><b>12.2</b> What Bragg diffraction misses</a></li>
<li class="chapter" data-level="12.3" data-path="short-range-order-and-pdf.html"><a href="short-range-order-and-pdf.html#pdf-captures-local-structure"><i class="fa fa-check"></i><b>12.3</b> PDF captures local structure</a></li>
<li class="chapter" data-level="12.4" data-path="short-range-order-and-pdf.html"><a href="short-range-order-and-pdf.html#computational-approach"><i class="fa fa-check"></i><b>12.4</b> Computational approach</a></li>
<li class="chapter" data-level="12.5" data-path="short-range-order-and-pdf.html"><a href="short-range-order-and-pdf.html#warren-cowley-parameters"><i class="fa fa-check"></i><b>12.5</b> Warren-Cowley parameters</a></li>
<li class="chapter" data-level="12.6" data-path="short-range-order-and-pdf.html"><a href="short-range-order-and-pdf.html#the-connection-to-energy-materials"><i class="fa fa-check"></i><b>12.6</b> The connection to energy materials</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="wrap-up.html"><a href="wrap-up.html"><i class="fa fa-check"></i><b>13</b> Wrap-up</a>
<ul>
<li class="chapter" data-level="13.1" data-path="wrap-up.html"><a href="wrap-up.html#the-two-axis-picture-revisited"><i class="fa fa-check"></i><b>13.1</b> The two-axis picture revisited</a></li>
<li class="chapter" data-level="13.2" data-path="wrap-up.html"><a href="wrap-up.html#er-choice-is-problem-dependent"><i class="fa fa-check"></i><b>13.2</b> E(r) choice is problem-dependent</a></li>
<li class="chapter" data-level="13.3" data-path="wrap-up.html"><a href="wrap-up.html#three-modes-of-interaction"><i class="fa fa-check"></i><b>13.3</b> Three modes of interaction</a></li>
<li class="chapter" data-level="13.4" data-path="wrap-up.html"><a href="wrap-up.html#bidirectionality"><i class="fa fa-check"></i><b>13.4</b> Bidirectionality</a></li>
<li class="chapter" data-level="13.5" data-path="wrap-up.html"><a href="wrap-up.html#where-to-go-from-here"><i class="fa fa-check"></i><b>13.5</b> Where to go from here</a></li>
<li class="chapter" data-level="13.6" data-path="wrap-up.html"><a href="wrap-up.html#resources"><i class="fa fa-check"></i><b>13.6</b> Resources</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="appendix-derivation-of-the-dynamical-matrix-for-periodic-systems.html"><a href="appendix-derivation-of-the-dynamical-matrix-for-periodic-systems.html"><i class="fa fa-check"></i><b>A</b> Appendix: Derivation of the dynamical matrix for periodic systems</a>
<ul>
<li class="chapter" data-level="A.1" data-path="appendix-derivation-of-the-dynamical-matrix-for-periodic-systems.html"><a href="appendix-derivation-of-the-dynamical-matrix-for-periodic-systems.html#setup-and-notation"><i class="fa fa-check"></i><b>A.1</b> Setup and notation</a></li>
<li class="chapter" data-level="A.2" data-path="appendix-derivation-of-the-dynamical-matrix-for-periodic-systems.html"><a href="appendix-derivation-of-the-dynamical-matrix-for-periodic-systems.html#translational-symmetry"><i class="fa fa-check"></i><b>A.2</b> Translational symmetry</a></li>
<li class="chapter" data-level="A.3" data-path="appendix-derivation-of-the-dynamical-matrix-for-periodic-systems.html"><a href="appendix-derivation-of-the-dynamical-matrix-for-periodic-systems.html#plane-wave-ansatz"><i class="fa fa-check"></i><b>A.3</b> Plane-wave ansatz</a></li>
<li class="chapter" data-level="A.4" data-path="appendix-derivation-of-the-dynamical-matrix-for-periodic-systems.html"><a href="appendix-derivation-of-the-dynamical-matrix-for-periodic-systems.html#substitution-into-equations-of-motion"><i class="fa fa-check"></i><b>A.4</b> Substitution into equations of motion</a></li>
<li class="chapter" data-level="A.5" data-path="appendix-derivation-of-the-dynamical-matrix-for-periodic-systems.html"><a href="appendix-derivation-of-the-dynamical-matrix-for-periodic-systems.html#the-dynamical-matrix"><i class="fa fa-check"></i><b>A.5</b> The dynamical matrix</a></li>
<li class="chapter" data-level="A.6" data-path="appendix-derivation-of-the-dynamical-matrix-for-periodic-systems.html"><a href="appendix-derivation-of-the-dynamical-matrix-for-periodic-systems.html#the-key-result"><i class="fa fa-check"></i><b>A.6</b> The key result</a></li>
<li class="chapter" data-level="A.7" data-path="appendix-derivation-of-the-dynamical-matrix-for-periodic-systems.html"><a href="appendix-derivation-of-the-dynamical-matrix-for-periodic-systems.html#connection-to-experiment"><i class="fa fa-check"></i><b>A.7</b> Connection to experiment</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Neutrons for Sustainable Energy Lecture Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="appendix-derivation-of-the-dynamical-matrix-for-periodic-systems" class="section level1 hasAnchor" number="14">
<h1><span class="header-section-number">A</span> Appendix: Derivation of the dynamical matrix for periodic systems<a href="appendix-derivation-of-the-dynamical-matrix-for-periodic-systems.html#appendix-derivation-of-the-dynamical-matrix-for-periodic-systems" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This appendix provides the full derivation of how translational symmetry reduces the phonon problem from a 3<i>N</i> × 3<i>N</i> eigenvalue problem (for <i>N</i> atoms in the crystal) to a 3<i>n</i> × 3<i>n</i> problem (for <i>n</i> atoms in the primitive cell) at each wavevector <strong>q</strong>.</p>
<div id="setup-and-notation" class="section level2 hasAnchor" number="14.1">
<h2><span class="header-section-number">A.1</span> Setup and notation<a href="appendix-derivation-of-the-dynamical-matrix-for-periodic-systems.html#setup-and-notation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Consider a periodic crystal with primitive lattice vectors. Let <strong>R</strong>ₗ denote the position of unit cell <span class="math inline">\(l\)</span>, and let atom <span class="math inline">\(i\)</span> within the cell sit at position <strong>R</strong>ₗ + <strong>τ</strong>ᵢ, where <strong>τ</strong>ᵢ is the position of atom <span class="math inline">\(i\)</span> within the primitive cell.</p>
<p>The displacement of atom <span class="math inline">\(i\)</span> in cell <span class="math inline">\(l\)</span> from its equilibrium position is <strong>u</strong>ᵢ(l). The equation of motion is:</p>
<p><span class="math display">\[m_i \frac{d^2 \mathbf{u}_i(l)}{dt^2} = -\sum_{l&#39;} \sum_j \Phi_{ij}(l, l&#39;) \, \mathbf{u}_j(l&#39;)\]</span></p>
<p>where <span class="math inline">\(\Phi_{ij}(l, l&#39;)\)</span> is the force constant matrix coupling atom <span class="math inline">\(i\)</span> in cell <span class="math inline">\(l\)</span> to atom <span class="math inline">\(j\)</span> in cell <span class="math inline">\(l&#39;\)</span>. This is a 3 × 3 matrix (coupling <i>x</i>, <i>y</i>, <i>z</i> components), but we suppress the Cartesian indices for clarity.</p>
</div>
<div id="translational-symmetry" class="section level2 hasAnchor" number="14.2">
<h2><span class="header-section-number">A.2</span> Translational symmetry<a href="appendix-derivation-of-the-dynamical-matrix-for-periodic-systems.html#translational-symmetry" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The key property is translational invariance: the force constants depend only on the separation between cells, not on which cell we started from:</p>
<p><span class="math display">\[\Phi_{ij}(l, l&#39;) = \Phi_{ij}(\mathbf{R}_l - \mathbf{R}_{l&#39;}) = \Phi_{ij}(\mathbf{R}_{l-l&#39;})\]</span></p>
<p>We can write this more simply by defining <span class="math inline">\(\mathbf{R} = \mathbf{R}_l− \mathbf{R}_{l^\prime}\)</span>, so <span class="math inline">\(\Psi_{ij}(\mathbf{R})\)</span> is the force constant coupling atom <span class="math inline">\(j\)</span> at the origin to atom <span class="math inline">\(i\)</span> in the cell at <span class="math inline">\(\mathbf{R}\)</span>.</p>
</div>
<div id="plane-wave-ansatz" class="section level2 hasAnchor" number="14.3">
<h2><span class="header-section-number">A.3</span> Plane-wave ansatz<a href="appendix-derivation-of-the-dynamical-matrix-for-periodic-systems.html#plane-wave-ansatz" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We seek solutions where all atoms oscillate at the same frequency ω. Based on the discussion in the main text, translational symmetry constrains the allowed phase relationships to plane waves. We therefore assume:</p>
<p><span class="math display">\[\mathbf{u}_i(l) = \mathbf{e}_i \exp(i\mathbf{q} \cdot \mathbf{R}_l) \exp(-i\omega t)\]</span></p>
<p>where <strong>e</strong>ᵢ is the displacement amplitude (a complex vector) for atom i within the unit cell, and <strong>q</strong> is the wavevector. The time dependence exp(−iω<i>t</i>) gives the harmonic oscillation; the spatial dependence exp(i<strong>q</strong>·<strong>R</strong>ₗ) encodes the phase variation from cell to cell.</p>
</div>
<div id="substitution-into-equations-of-motion" class="section level2 hasAnchor" number="14.4">
<h2><span class="header-section-number">A.4</span> Substitution into equations of motion<a href="appendix-derivation-of-the-dynamical-matrix-for-periodic-systems.html#substitution-into-equations-of-motion" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Substituting the plane-wave form into the equation of motion:</p>
<p><span class="math display">\[-m_i \omega^2 \mathbf{e}_i \exp(i\mathbf{q} \cdot \mathbf{R}_l) = -\sum_{l&#39;} \sum_j \Phi_{ij}(\mathbf{R}_l - \mathbf{R}_{l&#39;}) \, \mathbf{e}_j \exp(i\mathbf{q} \cdot \mathbf{R}_{l&#39;})\]</span></p>
<p>where we have cancelled the common exp(−iωt) factor from both sides.</p>
<p>Now we use translational invariance. Define <strong>R</strong> = <strong>R</strong>ₗ − <strong>R</strong>ₗ’, so <strong>R</strong>ₗ’ = <strong>R</strong>ₗ − <strong>R</strong>. The sum over l’ becomes a sum over <strong>R</strong>:</p>
<p><span class="math display">\[-m_i \omega^2 \mathbf{e}_i \exp(i\mathbf{q} \cdot \mathbf{R}_l) = -\sum_{\mathbf{R}} \sum_j \Phi_{ij}(\mathbf{R}) \, \mathbf{e}_j \exp(i\mathbf{q} \cdot (\mathbf{R}_l - \mathbf{R}))\]</span></p>
<p>The exp(i<strong>q</strong>·<strong>R</strong>ₗ) factor appears on both sides:</p>
<p><span class="math display">\[-m_i \omega^2 \mathbf{e}_i \exp(i\mathbf{q} \cdot \mathbf{R}_l) = -\sum_{\mathbf{R}} \sum_j \Phi_{ij}(\mathbf{R}) \, \mathbf{e}_j \exp(i\mathbf{q} \cdot \mathbf{R}_l) \exp(-i\mathbf{q} \cdot \mathbf{R})\]</span></p>
<p>Dividing both sides by exp(i<strong>q</strong>·<strong>R</strong>ₗ):</p>
<p><span class="math display">\[m_i \omega^2 \mathbf{e}_i = \sum_{\mathbf{R}} \sum_j \Phi_{ij}(\mathbf{R}) \exp(-i\mathbf{q} \cdot \mathbf{R}) \, \mathbf{e}_j\]</span></p>
</div>
<div id="the-dynamical-matrix" class="section level2 hasAnchor" number="14.5">
<h2><span class="header-section-number">A.5</span> The dynamical matrix<a href="appendix-derivation-of-the-dynamical-matrix-for-periodic-systems.html#the-dynamical-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Define the <strong>q</strong>-dependent force constant matrix:</p>
<p><span class="math display">\[C_{ij}(\mathbf{q}) = \sum_{\mathbf{R}} \Phi_{ij}(\mathbf{R}) \exp(-i\mathbf{q} \cdot \mathbf{R})\]</span></p>
<p>This is the Fourier transform of the real-space force constants. The equation of motion becomes:</p>
<p><span class="math display">\[m_i \omega^2 \mathbf{e}_i = \sum_j C_{ij}(\mathbf{q}) \, \mathbf{e}_j\]</span></p>
<p>To put this in standard eigenvalue form, we define mass-weighted displacements <strong>ẽ</strong>ᵢ = √mᵢ <strong>e</strong>ᵢ and the dynamical matrix:</p>
<p><span class="math display">\[D_{ij}(\mathbf{q}) = \frac{C_{ij}(\mathbf{q})}{\sqrt{m_i m_j}}\]</span></p>
<p>The equation becomes:</p>
<p><span class="math display">\[\omega^2 \tilde{\mathbf{e}}_i = \sum_j D_{ij}(\mathbf{q}) \, \tilde{\mathbf{e}}_j\]</span></p>
<p>or in matrix form:</p>
<p><span class="math display">\[\omega^2 \tilde{\mathbf{e}} = \mathbf{D}(\mathbf{q}) \tilde{\mathbf{e}}\]</span></p>
<p>This is a standard eigenvalue problem. The eigenvalues are ω² and the eigenvectors <strong>ẽ</strong> give the (mass-weighted) displacement patterns within the unit cell.</p>
</div>
<div id="the-key-result" class="section level2 hasAnchor" number="14.6">
<h2><span class="header-section-number">A.6</span> The key result<a href="appendix-derivation-of-the-dynamical-matrix-for-periodic-systems.html#the-key-result" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The dynamical matrix D(<strong>q</strong>) has dimensions 3n × 3n, where n is the number of atoms in the primitive cell. At each wavevector <strong>q</strong>, we diagonalise this matrix to obtain 3n eigenvalues ω²(<strong>q</strong>) and eigenvectors.</p>
<p>The full displacement pattern across the crystal is reconstructed by multiplying the unit-cell eigenvector by the phase factor:</p>
<p><span class="math display">\[\mathbf{u}_i(l) = \frac{\mathbf{e}_i}{\sqrt{m_i}} \exp(i\mathbf{q} \cdot \mathbf{R}_l) \exp(-i\omega t)\]</span></p>
<p>Different values of <strong>q</strong> give different phase relationships between unit cells, but the mathematical structure of the eigenvalue problem is the same at each <strong>q</strong>. This is why we can compute phonon dispersion by solving many small problems rather than one impossibly large one.</p>
</div>
<div id="connection-to-experiment" class="section level2 hasAnchor" number="14.7">
<h2><span class="header-section-number">A.7</span> Connection to experiment<a href="appendix-derivation-of-the-dynamical-matrix-for-periodic-systems.html#connection-to-experiment" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The phonon dispersion relation ω(<strong>q</strong>) can be measured by inelastic neutron scattering on single crystals, where the scattering condition relates the momentum transfer to <strong>q</strong>. For powder samples, the measurement averages over all <strong>q</strong>, giving the phonon density of states.</p>
<p>Computationally, we calculate D(<strong>q</strong>) on a grid of <strong>q</strong>-points in the Brillouin zone, diagonalise at each point, and either plot the dispersion along high-symmetry paths or integrate to obtain the density of states.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="wrap-up.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/bjmorgan/neutrons_for_sustainable_energy/main/appendices/phonon_derivation.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section"
  },
  "mathjax": {
    "extensions": "mhchem.js"
  },
  "mathjax_config": {
    "TeX": {
      "Macros": {
        "conc": [
          "[\mathrm{#1}]",
          1
        ],
        "diffc": [
          "\frac{\mathrm{d}\conc{#1}}{\mathrm{d}t}",
          1
        ]
      }
    }
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
