<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Phonon calculations | Computational Techniques for Sustainable Energy Materials</title>
  <meta name="description" content="Notes accompanying the Computational Tools lectures for the 2025 Neutrons for Sustainable Energy training school." />
  <meta name="generator" content="bookdown 0.46 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Phonon calculations | Computational Techniques for Sustainable Energy Materials" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Notes accompanying the Computational Tools lectures for the 2025 Neutrons for Sustainable Energy training school." />
  <meta name="github-repo" content="bjmorgan/neutrons_for_sustainable_energy" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Phonon calculations | Computational Techniques for Sustainable Energy Materials" />
  
  <meta name="twitter:description" content="Notes accompanying the Computational Tools lectures for the 2025 Neutrons for Sustainable Energy training school." />
  

<meta name="author" content="Benjamin J. Morgan" />


<meta name="date" content="2025-12-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="finding-minima-geometry-optimisation.html"/>
<link rel="next" href="molecular-dynamics-principles.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>



<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Neutrons for Sustainable Energy</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#shared-observables"><i class="fa fa-check"></i>Shared observables</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#scope"><i class="fa fa-check"></i>Scope</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#energy-materials"><i class="fa fa-check"></i>Energy materials</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-i-calculating-er.html"><a href="part-i-calculating-er.html"><i class="fa fa-check"></i>Part I: Calculating E(r)</a></li>
<li class="chapter" data-level="1" data-path="the-potential-energy-surface.html"><a href="the-potential-energy-surface.html"><i class="fa fa-check"></i><b>1</b> The potential energy surface</a>
<ul>
<li class="chapter" data-level="1.1" data-path="the-potential-energy-surface.html"><a href="the-potential-energy-surface.html#configuration-and-energy"><i class="fa fa-check"></i><b>1.1</b> Configuration and energy</a></li>
<li class="chapter" data-level="1.2" data-path="the-potential-energy-surface.html"><a href="the-potential-energy-surface.html#features-of-the-pes"><i class="fa fa-check"></i><b>1.2</b> Features of the PES</a></li>
<li class="chapter" data-level="1.3" data-path="the-potential-energy-surface.html"><a href="the-potential-energy-surface.html#two-questions"><i class="fa fa-check"></i><b>1.3</b> Two questions</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="classical-potentials.html"><a href="classical-potentials.html"><i class="fa fa-check"></i><b>2</b> Classical potentials</a>
<ul>
<li class="chapter" data-level="2.1" data-path="classical-potentials.html"><a href="classical-potentials.html#why-start-here"><i class="fa fa-check"></i><b>2.1</b> Why start here?</a></li>
<li class="chapter" data-level="2.2" data-path="classical-potentials.html"><a href="classical-potentials.html#the-simplest-model-pair-potentials"><i class="fa fa-check"></i><b>2.2</b> The simplest model: pair potentials</a></li>
<li class="chapter" data-level="2.3" data-path="classical-potentials.html"><a href="classical-potentials.html#building-a-potential-from-physics"><i class="fa fa-check"></i><b>2.3</b> Building a potential from physics</a></li>
<li class="chapter" data-level="2.4" data-path="classical-potentials.html"><a href="classical-potentials.html#periodic-systems"><i class="fa fa-check"></i><b>2.4</b> Periodic systems</a></li>
<li class="chapter" data-level="2.5" data-path="classical-potentials.html"><a href="classical-potentials.html#when-pair-potentials-arent-enough"><i class="fa fa-check"></i><b>2.5</b> When pair potentials aren’t enough</a></li>
<li class="chapter" data-level="2.6" data-path="classical-potentials.html"><a href="classical-potentials.html#the-parameterisation-problem"><i class="fa fa-check"></i><b>2.6</b> The parameterisation problem</a></li>
<li class="chapter" data-level="2.7" data-path="classical-potentials.html"><a href="classical-potentials.html#strengths-and-limitations"><i class="fa fa-check"></i><b>2.7</b> Strengths and limitations</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="density-functional-theory.html"><a href="density-functional-theory.html"><i class="fa fa-check"></i><b>3</b> Density functional theory</a>
<ul>
<li class="chapter" data-level="3.1" data-path="density-functional-theory.html"><a href="density-functional-theory.html#why-first-principles"><i class="fa fa-check"></i><b>3.1</b> Why first principles?</a></li>
<li class="chapter" data-level="3.2" data-path="density-functional-theory.html"><a href="density-functional-theory.html#from-wavefunctions-to-density"><i class="fa fa-check"></i><b>3.2</b> From wavefunctions to density</a></li>
<li class="chapter" data-level="3.3" data-path="density-functional-theory.html"><a href="density-functional-theory.html#the-kohn-sham-approach"><i class="fa fa-check"></i><b>3.3</b> The Kohn-Sham approach</a></li>
<li class="chapter" data-level="3.4" data-path="density-functional-theory.html"><a href="density-functional-theory.html#exchange-correlation-functionals"><i class="fa fa-check"></i><b>3.4</b> Exchange-correlation functionals</a></li>
<li class="chapter" data-level="3.5" data-path="density-functional-theory.html"><a href="density-functional-theory.html#strengths-and-limitations-1"><i class="fa fa-check"></i><b>3.5</b> Strengths and limitations</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mlips.html"><a href="mlips.html"><i class="fa fa-check"></i><b>4</b> Machine-learned interatomic potentials</a>
<ul>
<li class="chapter" data-level="4.1" data-path="mlips.html"><a href="mlips.html#motivation"><i class="fa fa-check"></i><b>4.1</b> Motivation</a></li>
<li class="chapter" data-level="4.2" data-path="mlips.html"><a href="mlips.html#how-mlips-work"><i class="fa fa-check"></i><b>4.2</b> How MLIPs work</a></li>
<li class="chapter" data-level="4.3" data-path="mlips.html"><a href="mlips.html#the-landscape"><i class="fa fa-check"></i><b>4.3</b> The landscape</a></li>
<li class="chapter" data-level="4.4" data-path="mlips.html"><a href="mlips.html#strengths-and-limitations-2"><i class="fa fa-check"></i><b>4.4</b> Strengths and limitations</a></li>
<li class="chapter" data-level="4.5" data-path="mlips.html"><a href="mlips.html#when-to-use"><i class="fa fa-check"></i><b>4.5</b> When to use</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-ii-structure-and-dynamics.html"><a href="part-ii-structure-and-dynamics.html"><i class="fa fa-check"></i>Part II: Structure and Dynamics</a></li>
<li class="chapter" data-level="5" data-path="finding-minima-geometry-optimisation.html"><a href="finding-minima-geometry-optimisation.html"><i class="fa fa-check"></i><b>5</b> Finding minima: geometry optimisation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="finding-minima-geometry-optimisation.html"><a href="finding-minima-geometry-optimisation.html#why-compute-a-structure"><i class="fa fa-check"></i><b>5.1</b> Why compute a structure?</a></li>
<li class="chapter" data-level="5.2" data-path="finding-minima-geometry-optimisation.html"><a href="finding-minima-geometry-optimisation.html#structures-and-minima"><i class="fa fa-check"></i><b>5.2</b> Structures and minima</a></li>
<li class="chapter" data-level="5.3" data-path="finding-minima-geometry-optimisation.html"><a href="finding-minima-geometry-optimisation.html#steepest-descent"><i class="fa fa-check"></i><b>5.3</b> Steepest descent</a></li>
<li class="chapter" data-level="5.4" data-path="finding-minima-geometry-optimisation.html"><a href="finding-minima-geometry-optimisation.html#doing-better-with-curvature"><i class="fa fa-check"></i><b>5.4</b> Doing better with curvature</a></li>
<li class="chapter" data-level="5.5" data-path="finding-minima-geometry-optimisation.html"><a href="finding-minima-geometry-optimisation.html#local-and-global-minima"><i class="fa fa-check"></i><b>5.5</b> Local and global minima</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="phonons.html"><a href="phonons.html"><i class="fa fa-check"></i><b>6</b> Phonon calculations</a>
<ul>
<li class="chapter" data-level="6.1" data-path="phonons.html"><a href="phonons.html#vibrations-around-equilibrium"><i class="fa fa-check"></i><b>6.1</b> Vibrations around equilibrium</a></li>
<li class="chapter" data-level="6.2" data-path="phonons.html"><a href="phonons.html#the-harmonic-approximation"><i class="fa fa-check"></i><b>6.2</b> The harmonic approximation</a></li>
<li class="chapter" data-level="6.3" data-path="phonons.html"><a href="phonons.html#many-atoms"><i class="fa fa-check"></i><b>6.3</b> Many atoms</a></li>
<li class="chapter" data-level="6.4" data-path="phonons.html"><a href="phonons.html#periodicity-simplifies-the-problem"><i class="fa fa-check"></i><b>6.4</b> Periodicity simplifies the problem</a></li>
<li class="chapter" data-level="6.5" data-path="phonons.html"><a href="phonons.html#acoustic-and-optical-branches"><i class="fa fa-check"></i><b>6.5</b> Acoustic and optical branches</a></li>
<li class="chapter" data-level="6.6" data-path="phonons.html"><a href="phonons.html#calculating-phonons-in-practice"><i class="fa fa-check"></i><b>6.6</b> Calculating phonons in practice</a></li>
<li class="chapter" data-level="6.7" data-path="phonons.html"><a href="phonons.html#what-you-get"><i class="fa fa-check"></i><b>6.7</b> What you get</a></li>
<li class="chapter" data-level="6.8" data-path="phonons.html"><a href="phonons.html#limitations"><i class="fa fa-check"></i><b>6.8</b> Limitations</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="molecular-dynamics-principles.html"><a href="molecular-dynamics-principles.html"><i class="fa fa-check"></i><b>7</b> Molecular dynamics: principles</a>
<ul>
<li class="chapter" data-level="7.1" data-path="molecular-dynamics-principles.html"><a href="molecular-dynamics-principles.html#from-local-curvature-to-global-exploration"><i class="fa fa-check"></i><b>7.1</b> From local curvature to global exploration</a></li>
<li class="chapter" data-level="7.2" data-path="molecular-dynamics-principles.html"><a href="molecular-dynamics-principles.html#equations-of-motion"><i class="fa fa-check"></i><b>7.2</b> Equations of motion</a></li>
<li class="chapter" data-level="7.3" data-path="molecular-dynamics-principles.html"><a href="molecular-dynamics-principles.html#numerical-integration"><i class="fa fa-check"></i><b>7.3</b> Numerical integration</a></li>
<li class="chapter" data-level="7.4" data-path="molecular-dynamics-principles.html"><a href="molecular-dynamics-principles.html#phase-space-and-trajectories"><i class="fa fa-check"></i><b>7.4</b> Phase space and trajectories</a></li>
<li class="chapter" data-level="7.5" data-path="molecular-dynamics-principles.html"><a href="molecular-dynamics-principles.html#ensembles-and-what-they-mean"><i class="fa fa-check"></i><b>7.5</b> Ensembles and what they mean</a></li>
<li class="chapter" data-level="7.6" data-path="molecular-dynamics-principles.html"><a href="molecular-dynamics-principles.html#thermostats-and-barostats"><i class="fa fa-check"></i><b>7.6</b> Thermostats and barostats</a></li>
<li class="chapter" data-level="7.7" data-path="molecular-dynamics-principles.html"><a href="molecular-dynamics-principles.html#what-you-get-1"><i class="fa fa-check"></i><b>7.7</b> What you get</a></li>
<li class="chapter" data-level="7.8" data-path="molecular-dynamics-principles.html"><a href="molecular-dynamics-principles.html#the-er-choice"><i class="fa fa-check"></i><b>7.8</b> The <span class="math inline">\(E(r)\)</span> choice</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="md-observables.html"><a href="md-observables.html"><i class="fa fa-check"></i><b>8</b> Molecular dynamics: observables and neutron connections</a>
<ul>
<li class="chapter" data-level="8.1" data-path="md-observables.html"><a href="md-observables.html#from-trajectories-to-observables"><i class="fa fa-check"></i><b>8.1</b> From trajectories to observables</a></li>
<li class="chapter" data-level="8.2" data-path="md-observables.html"><a href="md-observables.html#vibrational-density-of-states"><i class="fa fa-check"></i><b>8.2</b> Vibrational density of states</a></li>
<li class="chapter" data-level="8.3" data-path="md-observables.html"><a href="md-observables.html#ensemble-averaged-structure"><i class="fa fa-check"></i><b>8.3</b> Ensemble-averaged structure</a></li>
<li class="chapter" data-level="8.4" data-path="md-observables.html"><a href="md-observables.html#pair-distribution-functions"><i class="fa fa-check"></i><b>8.4</b> Pair distribution functions</a></li>
<li class="chapter" data-level="8.5" data-path="md-observables.html"><a href="md-observables.html#diffusion-and-mean-squared-displacement"><i class="fa fa-check"></i><b>8.5</b> Diffusion and mean squared displacement</a></li>
<li class="chapter" data-level="8.6" data-path="md-observables.html"><a href="md-observables.html#mechanisms-and-the-van-hove-correlation-function"><i class="fa fa-check"></i><b>8.6</b> Mechanisms and the Van Hove correlation function</a></li>
<li class="chapter" data-level="8.7" data-path="md-observables.html"><a href="md-observables.html#connection-to-sq-ω"><i class="fa fa-check"></i><b>8.7</b> Connection to S(Q, ω)</a></li>
<li class="chapter" data-level="8.8" data-path="md-observables.html"><a href="md-observables.html#the-computationalexperimental-loop"><i class="fa fa-check"></i><b>8.8</b> The computational–experimental loop</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-iii-configurational-disorder.html"><a href="part-iii-configurational-disorder.html"><i class="fa fa-check"></i>Part III: Configurational Disorder</a></li>
<li class="chapter" data-level="9" data-path="monte-carlo-sampling.html"><a href="monte-carlo-sampling.html"><i class="fa fa-check"></i><b>9</b> Monte Carlo sampling</a>
<ul>
<li class="chapter" data-level="9.1" data-path="monte-carlo-sampling.html"><a href="monte-carlo-sampling.html#beyond-molecular-dynamics"><i class="fa fa-check"></i><b>9.1</b> Beyond molecular dynamics</a></li>
<li class="chapter" data-level="9.2" data-path="monte-carlo-sampling.html"><a href="monte-carlo-sampling.html#the-goal-ensemble-averages"><i class="fa fa-check"></i><b>9.2</b> The goal: ensemble averages</a></li>
<li class="chapter" data-level="9.3" data-path="monte-carlo-sampling.html"><a href="monte-carlo-sampling.html#why-not-sample-uniformly"><i class="fa fa-check"></i><b>9.3</b> Why not sample uniformly?</a></li>
<li class="chapter" data-level="9.4" data-path="monte-carlo-sampling.html"><a href="monte-carlo-sampling.html#markov-chain-monte-carlo"><i class="fa fa-check"></i><b>9.4</b> Markov chain Monte Carlo</a></li>
<li class="chapter" data-level="9.5" data-path="monte-carlo-sampling.html"><a href="monte-carlo-sampling.html#the-metropolis-algorithm"><i class="fa fa-check"></i><b>9.5</b> The Metropolis algorithm</a></li>
<li class="chapter" data-level="9.6" data-path="monte-carlo-sampling.html"><a href="monte-carlo-sampling.html#what-you-get-2"><i class="fa fa-check"></i><b>9.6</b> What you get</a></li>
<li class="chapter" data-level="9.7" data-path="monte-carlo-sampling.html"><a href="monte-carlo-sampling.html#what-you-dont-get"><i class="fa fa-check"></i><b>9.7</b> What you don’t get</a></li>
<li class="chapter" data-level="9.8" data-path="monte-carlo-sampling.html"><a href="monte-carlo-sampling.html#neutron-connection"><i class="fa fa-check"></i><b>9.8</b> Neutron connection</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="cluster-expansion.html"><a href="cluster-expansion.html"><i class="fa fa-check"></i><b>10</b> Cluster expansion</a>
<ul>
<li class="chapter" data-level="10.1" data-path="cluster-expansion.html"><a href="cluster-expansion.html#the-problem"><i class="fa fa-check"></i><b>10.1</b> The problem</a></li>
<li class="chapter" data-level="10.2" data-path="cluster-expansion.html"><a href="cluster-expansion.html#the-idea"><i class="fa fa-check"></i><b>10.2</b> The idea</a></li>
<li class="chapter" data-level="10.3" data-path="cluster-expansion.html"><a href="cluster-expansion.html#symmetry-and-truncation"><i class="fa fa-check"></i><b>10.3</b> Symmetry and truncation</a></li>
<li class="chapter" data-level="10.4" data-path="cluster-expansion.html"><a href="cluster-expansion.html#fitting-the-expansion"><i class="fa fa-check"></i><b>10.4</b> Fitting the expansion</a></li>
<li class="chapter" data-level="10.5" data-path="cluster-expansion.html"><a href="cluster-expansion.html#what-you-get-3"><i class="fa fa-check"></i><b>10.5</b> What you get</a></li>
<li class="chapter" data-level="10.6" data-path="cluster-expansion.html"><a href="cluster-expansion.html#limitations-1"><i class="fa fa-check"></i><b>10.6</b> Limitations</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="short-range-order-and-pdf.html"><a href="short-range-order-and-pdf.html"><i class="fa fa-check"></i><b>11</b> Short-range order and PDF</a>
<ul>
<li class="chapter" data-level="11.1" data-path="short-range-order-and-pdf.html"><a href="short-range-order-and-pdf.html#long-range-order-vs-short-range-order"><i class="fa fa-check"></i><b>11.1</b> Long-range order vs short-range order</a></li>
<li class="chapter" data-level="11.2" data-path="short-range-order-and-pdf.html"><a href="short-range-order-and-pdf.html#what-bragg-diffraction-misses"><i class="fa fa-check"></i><b>11.2</b> What Bragg diffraction misses</a></li>
<li class="chapter" data-level="11.3" data-path="short-range-order-and-pdf.html"><a href="short-range-order-and-pdf.html#pdf-captures-local-structure"><i class="fa fa-check"></i><b>11.3</b> PDF captures local structure</a></li>
<li class="chapter" data-level="11.4" data-path="short-range-order-and-pdf.html"><a href="short-range-order-and-pdf.html#the-computational-approach"><i class="fa fa-check"></i><b>11.4</b> The computational approach</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="case-study-short-range-order-in-li2feso.html"><a href="case-study-short-range-order-in-li2feso.html"><i class="fa fa-check"></i><b>12</b> Case study: short-range order in Li<sub>2</sub>FeSO</a>
<ul>
<li class="chapter" data-level="12.1" data-path="case-study-short-range-order-in-li2feso.html"><a href="case-study-short-range-order-in-li2feso.html#the-puzzle"><i class="fa fa-check"></i><b>12.1</b> The puzzle</a></li>
<li class="chapter" data-level="12.2" data-path="case-study-short-range-order-in-li2feso.html"><a href="case-study-short-range-order-in-li2feso.html#the-computational-approach-1"><i class="fa fa-check"></i><b>12.2</b> The computational approach</a></li>
<li class="chapter" data-level="12.3" data-path="case-study-short-range-order-in-li2feso.html"><a href="case-study-short-range-order-in-li2feso.html#the-result-preferential-short-range-order"><i class="fa fa-check"></i><b>12.3</b> The result: preferential short-range order</a></li>
<li class="chapter" data-level="12.4" data-path="case-study-short-range-order-in-li2feso.html"><a href="case-study-short-range-order-in-li2feso.html#validation-against-experiment"><i class="fa fa-check"></i><b>12.4</b> Validation against experiment</a></li>
<li class="chapter" data-level="12.5" data-path="case-study-short-range-order-in-li2feso.html"><a href="case-study-short-range-order-in-li2feso.html#the-physical-origin-anion-polarisation"><i class="fa fa-check"></i><b>12.5</b> The physical origin: anion polarisation</a></li>
<li class="chapter" data-level="12.6" data-path="case-study-short-range-order-in-li2feso.html"><a href="case-study-short-range-order-in-li2feso.html#what-this-example-illustrates"><i class="fa fa-check"></i><b>12.6</b> What this example illustrates</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i>Conclusion</a>
<ul>
<li class="chapter" data-level="12.7" data-path="conclusion.html"><a href="conclusion.html#four-themes"><i class="fa fa-check"></i><b>12.7</b> Four themes</a></li>
<li class="chapter" data-level="12.8" data-path="conclusion.html"><a href="conclusion.html#what-now"><i class="fa fa-check"></i><b>12.8</b> What now?</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="appendix-dynamical-matrix.html"><a href="appendix-dynamical-matrix.html"><i class="fa fa-check"></i><b>A</b> Derivation of the dynamical matrix for periodic systems</a>
<ul>
<li class="chapter" data-level="A.1" data-path="appendix-dynamical-matrix.html"><a href="appendix-dynamical-matrix.html#setup-and-notation"><i class="fa fa-check"></i><b>A.1</b> Setup and notation</a></li>
<li class="chapter" data-level="A.2" data-path="appendix-dynamical-matrix.html"><a href="appendix-dynamical-matrix.html#translational-symmetry"><i class="fa fa-check"></i><b>A.2</b> Translational symmetry</a></li>
<li class="chapter" data-level="A.3" data-path="appendix-dynamical-matrix.html"><a href="appendix-dynamical-matrix.html#plane-wave-ansatz"><i class="fa fa-check"></i><b>A.3</b> Plane-wave ansatz</a></li>
<li class="chapter" data-level="A.4" data-path="appendix-dynamical-matrix.html"><a href="appendix-dynamical-matrix.html#substitution-into-equations-of-motion"><i class="fa fa-check"></i><b>A.4</b> Substitution into equations of motion</a></li>
<li class="chapter" data-level="A.5" data-path="appendix-dynamical-matrix.html"><a href="appendix-dynamical-matrix.html#the-dynamical-matrix"><i class="fa fa-check"></i><b>A.5</b> The dynamical matrix</a></li>
<li class="chapter" data-level="A.6" data-path="appendix-dynamical-matrix.html"><a href="appendix-dynamical-matrix.html#the-final-result"><i class="fa fa-check"></i><b>A.6</b> The final result</a></li>
<li class="chapter" data-level="A.7" data-path="appendix-dynamical-matrix.html"><a href="appendix-dynamical-matrix.html#connection-to-experiment"><i class="fa fa-check"></i><b>A.7</b> Connection to experiment</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Computational Techniques for Sustainable Energy Materials</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="phonons" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">6</span> Phonon calculations<a href="phonons.html#phonons" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="vibrations-around-equilibrium" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Vibrations around equilibrium<a href="phonons.html#vibrations-around-equilibrium" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Geometry optimisation finds a minimum on the potential energy surface — a configuration where forces vanish. But atoms do not sit motionless at these positions. At any temperature above absolute zero, thermal energy causes atoms to vibrate around their equilibrium sites.</p>
<p>This atomic motion is precisely what inelastic neutron scattering probes. When a neutron scatters inelastically from a sample, it exchanges energy with vibrational modes. The measured spectrum <span class="math inline">\(S(Q,\omega)\)</span> encodes information about how atoms move — their vibrational frequencies and displacement patterns.</p>
<p>Phonon calculations aim to predict this vibrational behaviour from the potential energy surface. The approach rests on a key observation: near a minimum, the PES is smooth and bowl-shaped. Small displacements from equilibrium produce restoring forces that push atoms back. The shape of the bowl — its curvature — determines the vibrational frequencies.</p>
</div>
<div id="the-harmonic-approximation" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> The harmonic approximation<a href="phonons.html#the-harmonic-approximation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Start with the simplest case: a single atom in a one-dimensional potential. Near a minimum, any smooth potential is approximately parabolic — the energy increases quadratically with displacement. This is the harmonic approximation:</p>
<p><span class="math display">\[E = \frac{1}{2}k x^2\]</span></p>
<p>where <span class="math inline">\(x\)</span> is the displacement from equilibrium and <span class="math inline">\(k\)</span> is the force constant, which measures the curvature of the potential at the minimum. Stiffer potentials have larger <span class="math inline">\(k\)</span>.</p>
<p>The force on the atom is:</p>
<p><span class="math display">\[F = -\frac{dE}{dx} = -kx\]</span></p>
<p>This is a restoring force: it points back toward equilibrium, with strength proportional to the displacement. The equation of motion is:</p>
<p><span class="math display">\[m\frac{d^2 x}{dt^2} = -kx\]</span></p>
<p>The solution is sinusoidal oscillation at a single frequency:</p>
<p><span class="math display">\[\omega = \sqrt{\frac{k}{m}}\]</span></p>
<p>Stiffer potentials (larger <span class="math inline">\(k\)</span>) give higher frequencies. Heavier atoms give lower frequencies. One atom, one frequency — the curvature of the potential energy surface determines the vibrational frequency.</p>
</div>
<div id="many-atoms" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Many atoms<a href="phonons.html#many-atoms" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For <span class="math inline">\(N\)</span> atoms in three dimensions, there are <span class="math inline">\(3N\)</span> displacement coordinates. Near equilibrium, the same logic applies: the potential is approximately quadratic in the displacements. But now the curvature is described by a matrix — the Hessian:</p>
<p><span class="math display">\[E = E_0 + \frac{1}{2}\sum_{ij} H_{ij} \, \delta r_i \, \delta r_j\]</span></p>
<p>where <span class="math inline">\(\delta r_i\)</span> is a displacement coordinate and <span class="math inline">\(H_{ij} = \partial^2 E / \partial r_i \partial r_j\)</span> is the matrix of second derivatives evaluated at the minimum. The Hessian captures how the energy changes when atoms move: the diagonal elements describe the restoring force on each atom; the off-diagonal elements describe how motion of one atom affects the force on another.</p>
<p>Each atom obeys Newton’s second law, but now the equations are coupled — the force on atom <span class="math inline">\(i\)</span> depends on the displacements of other atoms:</p>
<p><span class="math display">\[m_i \frac{d^2 \delta r_i}{dt^2} = -\sum_j H_{ij} \, \delta r_j\]</span></p>
<p>This is a system of coupled differential equations. We seek solutions where all atoms oscillate at the same frequency — normal modes. For a harmonic oscillator, solutions are sinusoidal in time. It is mathematically convenient to write these as complex exponentials <span class="math inline">\(\delta r_i(t) = u_i \exp(i\omega t)\)</span>, with the understanding that the physical displacement is the real part. Differentiating twice:</p>
<p><span class="math display">\[\frac{d^2 \delta r_i}{dt^2} = -\omega^2 u_i \exp(i\omega t)\]</span></p>
<p>Substituting into the equation of motion, the <span class="math inline">\(\exp(i\omega t)\)</span> factors appear on both sides and cancel, leaving:</p>
<p><span class="math display">\[m_i \omega^2 u_i = \sum_j H_{ij} u_j\]</span></p>
<p>This is an eigenvalue problem, though not quite in standard form because of the mass factor. Introducing the mass-weighted dynamical matrix:</p>
<p><span class="math display">\[D_{ij} = \frac{H_{ij}}{\sqrt{m_i m_j}}\]</span></p>
<p>converts this to standard form. Diagonalising <span class="math inline">\(\mathbf{D}\)</span> gives eigenvalues <span class="math inline">\(\omega^2\)</span> and eigenvectors that describe the displacement patterns — which atoms move, in what directions, with what relative amplitudes. Each eigenvector corresponds to a normal mode: a collective motion in which all atoms oscillate at the same frequency, maintaining fixed phase relationships.</p>
<p>For <span class="math inline">\(N\)</span> atoms in three dimensions, there are <span class="math inline">\(3N\)</span> eigenvalues and hence <span class="math inline">\(3N\)</span> normal modes. Three of these correspond to uniform translation (zero frequency). The remaining <span class="math inline">\(3N - 3\)</span> are the vibrational modes.</p>
<p>This is the complete solution — in principle. In practice, diagonalising a <span class="math inline">\(3N \times 3N\)</span> matrix for a macroscopic crystal is impossible.</p>
</div>
<div id="periodicity-simplifies-the-problem" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Periodicity simplifies the problem<a href="phonons.html#periodicity-simplifies-the-problem" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For a macroscopic crystal, the approach above is intractable — we cannot diagonalise a matrix with <span class="math inline">\(10^{23}\)</span> rows. But crystals have translational symmetry, and this transforms the problem.</p>
<p>Every unit cell has identical surroundings. The forces on an atom in cell 1 follow the same rules as the forces on the equivalent atom in cell 2, cell 3, or any other cell. This means the pattern of motion within each cell must be the same everywhere — what can vary is only the phase. Cell 2 might be doing exactly what cell 1 is doing, just slightly delayed (or advanced). This phase relationship between cells is the key.</p>
<p>Translational symmetry constrains which phase relationships are allowed. If the physics is unchanged by shifting the crystal by a lattice vector <span class="math inline">\(\mathbf{R}\)</span>, the displacement pattern must transform consistently under that shift. The functions with this property are plane waves <span class="math inline">\(e^{i\mathbf{q}\cdot\mathbf{R}}\)</span>, where the wavevector <span class="math inline">\(\mathbf{q}\)</span> labels the phase relationship.</p>
<p>At <span class="math inline">\(\mathbf{q} = 0\)</span>, all cells move in phase — the same displacement everywhere, at the same time. As <span class="math inline">\(\mathbf{q}\)</span> increases, a phase shift develops between neighbouring cells: one cell lags slightly behind the next. At the Brillouin zone boundary, adjacent cells move in exact antiphase — when one moves left, its neighbour moves right.</p>
<p>The frequency depends on which phase relationship we are looking at. Consider a chain of atoms connected by springs. When neighbours move together (<span class="math inline">\(\mathbf{q} = 0\)</span>), the springs between them do not stretch — there is no restoring force from those springs, so the frequency is low (in fact zero for acoustic modes, since this is just uniform translation). When neighbours move in opposite directions (zone boundary), the springs are maximally stretched and compressed, the restoring forces are strongest, and the frequency is highest. The dispersion relation <span class="math inline">\(\omega(\mathbf{q})\)</span> encodes this: frequency varies with wavevector because different phase relationships produce different restoring forces.</p>
<p>The mathematical consequence is that the dynamical matrix becomes block-diagonal in the plane-wave basis. Instead of one <span class="math inline">\(3N \times 3N\)</span> matrix for the whole crystal, there is a <span class="math inline">\(3n \times 3n\)</span> matrix <span class="math inline">\(D(\mathbf{q})\)</span> at each wavevector, where <span class="math inline">\(n\)</span> is the number of atoms in the primitive cell. We solve many small problems instead of one impossible one. The dynamical matrix at wavevector <span class="math inline">\(\mathbf{q}\)</span> is the Fourier transform of the real-space force constants:</p>
<p><span class="math display">\[D_{ij}(\mathbf{q}) = \frac{1}{\sqrt{m_i m_j}} \sum_{\mathbf{R}} \Phi_{ij}(\mathbf{R}) \, e^{-i\mathbf{q}\cdot\mathbf{R}}\]</span></p>
<p>where <span class="math inline">\(\Phi_{ij}(\mathbf{R})\)</span> is the force constant coupling atoms <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> separated by lattice vector <span class="math inline">\(\mathbf{R}\)</span>. The full derivation is given in Appendix <a href="appendix-dynamical-matrix.html#appendix-dynamical-matrix">A</a>.</p>
<p>At each <span class="math inline">\(\mathbf{q}\)</span>, diagonalising <span class="math inline">\(D(\mathbf{q})\)</span> gives <span class="math inline">\(3n\)</span> eigenvalues — the squared frequencies <span class="math inline">\(\omega^2\)</span> of the <span class="math inline">\(3n\)</span> branches at that wavevector. The eigenvectors describe the displacement pattern within the unit cell; the full displacement pattern across the crystal is this eigenvector multiplied by the phase factor <span class="math inline">\(e^{i\mathbf{q}\cdot\mathbf{R}}\)</span>.</p>
<p>The phonon band structure plots these dispersion curves <span class="math inline">\(\omega(\mathbf{q})\)</span> along high-symmetry paths through the Brillouin zone. The phonon density of states integrates over all wavevectors, giving the distribution of frequencies regardless of which <span class="math inline">\(\mathbf{q}\)</span> they came from — this is what powder INS measures directly.</p>
</div>
<div id="acoustic-and-optical-branches" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Acoustic and optical branches<a href="phonons.html#acoustic-and-optical-branches" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For a structure with one atom per primitive cell, there are three branches — one for each direction of motion. These are the acoustic branches: at long wavelength (<span class="math inline">\(\mathbf{q} \to 0\)</span>), they describe sound waves, with frequency proportional to wavevector.</p>
<p>With more atoms per cell, additional branches appear. Consider two atoms per cell. At <span class="math inline">\(\mathbf{q} = 0\)</span>, one solution has both atoms moving together — uniform translation of the unit cell, with <span class="math inline">\(\omega = 0\)</span>. This is the acoustic mode at long wavelength. Another solution has the atoms moving in opposite directions while the centre of mass stays fixed. This costs energy even at <span class="math inline">\(\mathbf{q} = 0\)</span>, so the frequency is non-zero — an optical mode. In ionic crystals, this out-of-phase motion creates an oscillating electric dipole that can couple to light, hence the name.</p>
<p>In general, <span class="math inline">\(n\)</span> atoms per cell gives <span class="math inline">\(3n\)</span> branches: 3 acoustic and <span class="math inline">\(3n - 3\)</span> optical. The acoustic branches have <span class="math inline">\(\omega \to 0\)</span> as <span class="math inline">\(\mathbf{q} \to 0\)</span>; the optical branches have finite frequency at the zone centre.</p>
</div>
<div id="calculating-phonons-in-practice" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> Calculating phonons in practice<a href="phonons.html#calculating-phonons-in-practice" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Phonon calculations require the Hessian — the second derivatives of energy with respect to atomic positions. Most <span class="math inline">\(E(\mathbf{r})\)</span> methods provide forces (first derivatives) directly, but not second derivatives. However, the Hessian can be built from forces by finite differences.</p>
<p>The finite displacement method works by displacing each atom in turn and seeing how the forces change. For each atom and each Cartesian direction, the atom is shifted by a small amount <span class="math inline">\(+\delta r\)</span>, the forces on all atoms are calculated, then the atom is shifted by <span class="math inline">\(-\delta r\)</span> and the forces recalculated. The difference in forces, divided by the displacement, gives the second derivatives:</p>
<p><span class="math display">\[H_{ij} \approx -\frac{F_i(r_j + \delta r) - F_i(r_j - \delta r)}{2\delta r}\]</span></p>
<p>For a system with <span class="math inline">\(n\)</span> atoms in the primitive cell, this requires <span class="math inline">\(6n\)</span> force calculations — positive and negative displacements in each of the three Cartesian directions for each atom. Symmetry often reduces this: if two displacements are related by a symmetry operation, only one needs to be calculated.</p>
<p>The calculation is performed in a supercell. The supercell must be large enough that a displaced atom does not interact significantly with its own periodic images — otherwise the calculated force constants are contaminated by artificial periodicity. Larger supercells also give denser sampling of <span class="math inline">\(\mathbf{q}\)</span>-points in the Brillouin zone.</p>
<p>Density functional perturbation theory (DFPT) offers an alternative. Instead of displacing atoms and recalculating, it computes the response of the electronic structure to atomic displacements analytically within perturbation theory. This gives phonons at arbitrary <span class="math inline">\(\mathbf{q}\)</span>-points without needing supercells, but the method is more complex and only available for certain <span class="math inline">\(E(\mathbf{r})\)</span> methods.</p>
</div>
<div id="what-you-get" class="section level2 hasAnchor" number="6.7">
<h2><span class="header-section-number">6.7</span> What you get<a href="phonons.html#what-you-get" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Phonon calculations provide both frequencies and displacement patterns — both eigenvalues and eigenvectors of the dynamical matrix.</p>
<p>The phonon band structure shows how frequencies vary with wavevector, plotted along high-symmetry paths through the Brillouin zone. This can be compared directly with single-crystal INS measurements, where the scattering geometry selects specific <span class="math inline">\(\mathbf{q}\)</span> values. Features like avoided crossings, soft modes, and the gap between acoustic and optical branches are all visible in the dispersion curves.</p>
<p>The phonon density of states shows the distribution of vibrational frequencies, integrated over all wavevectors. This is what powder INS measures — the sample averages over all crystal orientations, so information about specific <span class="math inline">\(\mathbf{q}\)</span> values is lost, but the distribution of frequencies remains. Peaks in the density of states correspond to flat regions in the dispersion where many modes have similar frequencies.</p>
<p>From the phonon frequencies, thermodynamic quantities follow from statistical mechanics. The vibrational contribution to the free energy is:</p>
<p><span class="math display">\[F_{\text{vib}} = \sum_{\mathbf{q},\nu} \left[ \frac{\hbar\omega_{\mathbf{q}\nu}}{2} + k_B T \ln\left(1 - e^{-\hbar\omega_{\mathbf{q}\nu}/k_B T}\right) \right]\]</span></p>
<p>where the sum runs over all wavevectors <span class="math inline">\(\mathbf{q}\)</span> and branches <span class="math inline">\(\nu\)</span>. The first term is the zero-point energy; the second captures thermal occupation. Heat capacity and entropy follow by differentiation. These quantities matter for phase stability at finite temperature — a phase with higher energy at 0 K may become stable at higher temperatures if it has more low-frequency modes and hence higher vibrational entropy.</p>
</div>
<div id="limitations" class="section level2 hasAnchor" number="6.8">
<h2><span class="header-section-number">6.8</span> Limitations<a href="phonons.html#limitations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The harmonic approximation assumes the potential is quadratic — that displacements remain small enough for the parabolic approximation to hold. This works well at low temperatures, where atoms stay close to their equilibrium positions.</p>
<p>At higher temperatures, atoms venture further from equilibrium and sample regions where the potential deviates from a parabola. Effects that the harmonic picture cannot capture become significant. Phonon frequencies shift with temperature. Phonons scatter from each other, giving finite thermal conductivity. Thermal expansion occurs — something a purely harmonic crystal cannot exhibit, since the equilibrium positions would be temperature-independent.</p>
<p>Including anharmonic effects is possible but substantially more expensive. The third-order force constants describe three-phonon interactions: one phonon decaying into two, or two combining into one. These processes are responsible for thermal resistance. Fourth-order terms describe four-phonon processes. The number of terms grows rapidly with order, and the modes are no longer independent — the simple eigenvalue picture breaks down.</p>
<p>For some systems, the harmonic picture fails qualitatively rather than just quantitatively. Superionic conductors have mobile ions that diffuse through the structure rather than vibrating around fixed sites — there is no equilibrium position to expand around. Soft modes with frequencies approaching zero signal structural instabilities: the curvature of the PES is nearly flat or even negative in some direction, and the structure may be unstable. Phase transitions involve atoms moving between different potential wells, not oscillating within one.</p>
<p>For these situations, molecular dynamics offers an alternative. Rather than assuming harmonic motion and solving for frequencies, MD follows the actual atomic trajectories on the full potential energy surface. Vibrational information can then be extracted from velocity autocorrelation functions, as described in Chapter <a href="md-observables.html#md-observables">8</a>. This captures anharmonicity naturally, though at greater computational cost.
```</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="finding-minima-geometry-optimisation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="molecular-dynamics-principles.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/bjmorgan/neutrons_for_sustainable_energy/main/chapters/phonons.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section"
  },
  "mathjax": {
    "extensions": "mhchem.js"
  },
  "mathjax_config": {
    "TeX": {
      "Macros": {
        "conc": [
          "[\mathrm{#1}]",
          1
        ],
        "diffc": [
          "\frac{\mathrm{d}\conc{#1}}{\mathrm{d}t}",
          1
        ]
      }
    }
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
