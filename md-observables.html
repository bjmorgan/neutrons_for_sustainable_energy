<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 Molecular dynamics: observables and neutron connections | Computational Techniques for Sustainable Energy Materials</title>
  <meta name="description" content="Notes accompanying the Computational Tools lectures for the 2025 Neutrons for Sustainable Energy training school." />
  <meta name="generator" content="bookdown 0.46 and GitBook 2.6.7" />

  <meta property="og:title" content="8 Molecular dynamics: observables and neutron connections | Computational Techniques for Sustainable Energy Materials" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Notes accompanying the Computational Tools lectures for the 2025 Neutrons for Sustainable Energy training school." />
  <meta name="github-repo" content="bjmorgan/neutrons_for_sustainable_energy" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 Molecular dynamics: observables and neutron connections | Computational Techniques for Sustainable Energy Materials" />
  
  <meta name="twitter:description" content="Notes accompanying the Computational Tools lectures for the 2025 Neutrons for Sustainable Energy training school." />
  

<meta name="author" content="Benjamin J. Morgan" />


<meta name="date" content="2025-12-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="molecular-dynamics-principles.html"/>
<link rel="next" href="part-iii-configurational-disorder.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>



<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Neutrons for Sustainable Energy</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#shared-observables"><i class="fa fa-check"></i>Shared observables</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#scope"><i class="fa fa-check"></i>Scope</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#energy-materials"><i class="fa fa-check"></i>Energy materials</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-i-calculating-er.html"><a href="part-i-calculating-er.html"><i class="fa fa-check"></i>Part I: Calculating E(r)</a></li>
<li class="chapter" data-level="1" data-path="the-potential-energy-surface.html"><a href="the-potential-energy-surface.html"><i class="fa fa-check"></i><b>1</b> The potential energy surface</a>
<ul>
<li class="chapter" data-level="1.1" data-path="the-potential-energy-surface.html"><a href="the-potential-energy-surface.html#configuration-and-energy"><i class="fa fa-check"></i><b>1.1</b> Configuration and energy</a></li>
<li class="chapter" data-level="1.2" data-path="the-potential-energy-surface.html"><a href="the-potential-energy-surface.html#features-of-the-pes"><i class="fa fa-check"></i><b>1.2</b> Features of the PES</a></li>
<li class="chapter" data-level="1.3" data-path="the-potential-energy-surface.html"><a href="the-potential-energy-surface.html#two-questions"><i class="fa fa-check"></i><b>1.3</b> Two questions</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="classical-potentials.html"><a href="classical-potentials.html"><i class="fa fa-check"></i><b>2</b> Classical potentials</a>
<ul>
<li class="chapter" data-level="2.1" data-path="classical-potentials.html"><a href="classical-potentials.html#why-start-here"><i class="fa fa-check"></i><b>2.1</b> Why start here?</a></li>
<li class="chapter" data-level="2.2" data-path="classical-potentials.html"><a href="classical-potentials.html#the-simplest-model-pair-potentials"><i class="fa fa-check"></i><b>2.2</b> The simplest model: pair potentials</a></li>
<li class="chapter" data-level="2.3" data-path="classical-potentials.html"><a href="classical-potentials.html#building-a-potential-from-physics"><i class="fa fa-check"></i><b>2.3</b> Building a potential from physics</a></li>
<li class="chapter" data-level="2.4" data-path="classical-potentials.html"><a href="classical-potentials.html#periodic-systems"><i class="fa fa-check"></i><b>2.4</b> Periodic systems</a></li>
<li class="chapter" data-level="2.5" data-path="classical-potentials.html"><a href="classical-potentials.html#when-pair-potentials-arent-enough"><i class="fa fa-check"></i><b>2.5</b> When pair potentials aren’t enough</a></li>
<li class="chapter" data-level="2.6" data-path="classical-potentials.html"><a href="classical-potentials.html#the-parameterisation-problem"><i class="fa fa-check"></i><b>2.6</b> The parameterisation problem</a></li>
<li class="chapter" data-level="2.7" data-path="classical-potentials.html"><a href="classical-potentials.html#strengths-and-limitations"><i class="fa fa-check"></i><b>2.7</b> Strengths and limitations</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="density-functional-theory.html"><a href="density-functional-theory.html"><i class="fa fa-check"></i><b>3</b> Density functional theory</a>
<ul>
<li class="chapter" data-level="3.1" data-path="density-functional-theory.html"><a href="density-functional-theory.html#why-first-principles"><i class="fa fa-check"></i><b>3.1</b> Why first principles?</a></li>
<li class="chapter" data-level="3.2" data-path="density-functional-theory.html"><a href="density-functional-theory.html#from-wavefunctions-to-density"><i class="fa fa-check"></i><b>3.2</b> From wavefunctions to density</a></li>
<li class="chapter" data-level="3.3" data-path="density-functional-theory.html"><a href="density-functional-theory.html#the-kohn-sham-approach"><i class="fa fa-check"></i><b>3.3</b> The Kohn-Sham approach</a></li>
<li class="chapter" data-level="3.4" data-path="density-functional-theory.html"><a href="density-functional-theory.html#exchange-correlation-functionals"><i class="fa fa-check"></i><b>3.4</b> Exchange-correlation functionals</a></li>
<li class="chapter" data-level="3.5" data-path="density-functional-theory.html"><a href="density-functional-theory.html#strengths-and-limitations-1"><i class="fa fa-check"></i><b>3.5</b> Strengths and limitations</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mlips.html"><a href="mlips.html"><i class="fa fa-check"></i><b>4</b> Machine-learned interatomic potentials</a>
<ul>
<li class="chapter" data-level="4.1" data-path="mlips.html"><a href="mlips.html#motivation"><i class="fa fa-check"></i><b>4.1</b> Motivation</a></li>
<li class="chapter" data-level="4.2" data-path="mlips.html"><a href="mlips.html#how-mlips-work"><i class="fa fa-check"></i><b>4.2</b> How MLIPs work</a></li>
<li class="chapter" data-level="4.3" data-path="mlips.html"><a href="mlips.html#the-landscape"><i class="fa fa-check"></i><b>4.3</b> The landscape</a></li>
<li class="chapter" data-level="4.4" data-path="mlips.html"><a href="mlips.html#strengths-and-limitations-2"><i class="fa fa-check"></i><b>4.4</b> Strengths and limitations</a></li>
<li class="chapter" data-level="4.5" data-path="mlips.html"><a href="mlips.html#when-to-use"><i class="fa fa-check"></i><b>4.5</b> When to use</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-ii-structure-and-dynamics.html"><a href="part-ii-structure-and-dynamics.html"><i class="fa fa-check"></i>Part II: Structure and Dynamics</a></li>
<li class="chapter" data-level="5" data-path="finding-minima-geometry-optimisation.html"><a href="finding-minima-geometry-optimisation.html"><i class="fa fa-check"></i><b>5</b> Finding minima: geometry optimisation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="finding-minima-geometry-optimisation.html"><a href="finding-minima-geometry-optimisation.html#why-compute-a-structure"><i class="fa fa-check"></i><b>5.1</b> Why compute a structure?</a></li>
<li class="chapter" data-level="5.2" data-path="finding-minima-geometry-optimisation.html"><a href="finding-minima-geometry-optimisation.html#structures-and-minima"><i class="fa fa-check"></i><b>5.2</b> Structures and minima</a></li>
<li class="chapter" data-level="5.3" data-path="finding-minima-geometry-optimisation.html"><a href="finding-minima-geometry-optimisation.html#steepest-descent"><i class="fa fa-check"></i><b>5.3</b> Steepest descent</a></li>
<li class="chapter" data-level="5.4" data-path="finding-minima-geometry-optimisation.html"><a href="finding-minima-geometry-optimisation.html#doing-better-with-curvature"><i class="fa fa-check"></i><b>5.4</b> Doing better with curvature</a></li>
<li class="chapter" data-level="5.5" data-path="finding-minima-geometry-optimisation.html"><a href="finding-minima-geometry-optimisation.html#local-and-global-minima"><i class="fa fa-check"></i><b>5.5</b> Local and global minima</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="phonons.html"><a href="phonons.html"><i class="fa fa-check"></i><b>6</b> Phonon calculations</a>
<ul>
<li class="chapter" data-level="6.1" data-path="phonons.html"><a href="phonons.html#vibrations-around-equilibrium"><i class="fa fa-check"></i><b>6.1</b> Vibrations around equilibrium</a></li>
<li class="chapter" data-level="6.2" data-path="phonons.html"><a href="phonons.html#the-harmonic-approximation"><i class="fa fa-check"></i><b>6.2</b> The harmonic approximation</a></li>
<li class="chapter" data-level="6.3" data-path="phonons.html"><a href="phonons.html#many-atoms"><i class="fa fa-check"></i><b>6.3</b> Many atoms</a></li>
<li class="chapter" data-level="6.4" data-path="phonons.html"><a href="phonons.html#periodicity-simplifies-the-problem"><i class="fa fa-check"></i><b>6.4</b> Periodicity simplifies the problem</a></li>
<li class="chapter" data-level="6.5" data-path="phonons.html"><a href="phonons.html#acoustic-and-optical-branches"><i class="fa fa-check"></i><b>6.5</b> Acoustic and optical branches</a></li>
<li class="chapter" data-level="6.6" data-path="phonons.html"><a href="phonons.html#calculating-phonons-in-practice"><i class="fa fa-check"></i><b>6.6</b> Calculating phonons in practice</a></li>
<li class="chapter" data-level="6.7" data-path="phonons.html"><a href="phonons.html#what-you-get"><i class="fa fa-check"></i><b>6.7</b> What you get</a></li>
<li class="chapter" data-level="6.8" data-path="phonons.html"><a href="phonons.html#limitations"><i class="fa fa-check"></i><b>6.8</b> Limitations</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="molecular-dynamics-principles.html"><a href="molecular-dynamics-principles.html"><i class="fa fa-check"></i><b>7</b> Molecular dynamics: principles</a>
<ul>
<li class="chapter" data-level="7.1" data-path="molecular-dynamics-principles.html"><a href="molecular-dynamics-principles.html#from-local-curvature-to-global-exploration"><i class="fa fa-check"></i><b>7.1</b> From local curvature to global exploration</a></li>
<li class="chapter" data-level="7.2" data-path="molecular-dynamics-principles.html"><a href="molecular-dynamics-principles.html#equations-of-motion"><i class="fa fa-check"></i><b>7.2</b> Equations of motion</a></li>
<li class="chapter" data-level="7.3" data-path="molecular-dynamics-principles.html"><a href="molecular-dynamics-principles.html#numerical-integration"><i class="fa fa-check"></i><b>7.3</b> Numerical integration</a></li>
<li class="chapter" data-level="7.4" data-path="molecular-dynamics-principles.html"><a href="molecular-dynamics-principles.html#velocity-verlet"><i class="fa fa-check"></i><b>7.4</b> Velocity Verlet</a></li>
<li class="chapter" data-level="7.5" data-path="molecular-dynamics-principles.html"><a href="molecular-dynamics-principles.html#phase-space-and-trajectories"><i class="fa fa-check"></i><b>7.5</b> Phase space and trajectories</a></li>
<li class="chapter" data-level="7.6" data-path="molecular-dynamics-principles.html"><a href="molecular-dynamics-principles.html#ensembles-and-what-they-mean"><i class="fa fa-check"></i><b>7.6</b> Ensembles and what they mean</a></li>
<li class="chapter" data-level="7.7" data-path="molecular-dynamics-principles.html"><a href="molecular-dynamics-principles.html#thermostats-and-barostats"><i class="fa fa-check"></i><b>7.7</b> Thermostats and barostats</a></li>
<li class="chapter" data-level="7.8" data-path="molecular-dynamics-principles.html"><a href="molecular-dynamics-principles.html#what-you-get-1"><i class="fa fa-check"></i><b>7.8</b> What you get</a></li>
<li class="chapter" data-level="7.9" data-path="molecular-dynamics-principles.html"><a href="molecular-dynamics-principles.html#the-er-choice"><i class="fa fa-check"></i><b>7.9</b> The <span class="math inline">\(E(r)\)</span> choice</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="md-observables.html"><a href="md-observables.html"><i class="fa fa-check"></i><b>8</b> Molecular dynamics: observables and neutron connections</a>
<ul>
<li class="chapter" data-level="8.1" data-path="md-observables.html"><a href="md-observables.html#from-trajectories-to-observables"><i class="fa fa-check"></i><b>8.1</b> From trajectories to observables</a></li>
<li class="chapter" data-level="8.2" data-path="md-observables.html"><a href="md-observables.html#ensemble-averaged-structure"><i class="fa fa-check"></i><b>8.2</b> Ensemble-averaged structure</a></li>
<li class="chapter" data-level="8.3" data-path="md-observables.html"><a href="md-observables.html#pair-distribution-functions"><i class="fa fa-check"></i><b>8.3</b> Pair distribution functions</a></li>
<li class="chapter" data-level="8.4" data-path="md-observables.html"><a href="md-observables.html#dynamics-and-the-dynamic-structure-factor"><i class="fa fa-check"></i><b>8.4</b> Dynamics and the dynamic structure factor</a></li>
<li class="chapter" data-level="8.5" data-path="md-observables.html"><a href="md-observables.html#time-correlation-functions"><i class="fa fa-check"></i><b>8.5</b> Time correlation functions</a></li>
<li class="chapter" data-level="8.6" data-path="md-observables.html"><a href="md-observables.html#vibrational-density-of-states"><i class="fa fa-check"></i><b>8.6</b> Vibrational density of states</a></li>
<li class="chapter" data-level="8.7" data-path="md-observables.html"><a href="md-observables.html#diffusion-and-mean-squared-displacement"><i class="fa fa-check"></i><b>8.7</b> Diffusion and mean squared displacement</a></li>
<li class="chapter" data-level="8.8" data-path="md-observables.html"><a href="md-observables.html#mechanistic-insight-from-trajectories"><i class="fa fa-check"></i><b>8.8</b> Mechanistic insight from trajectories</a></li>
<li class="chapter" data-level="8.9" data-path="md-observables.html"><a href="md-observables.html#the-van-hove-correlation-function"><i class="fa fa-check"></i><b>8.9</b> The Van Hove correlation function</a></li>
<li class="chapter" data-level="8.10" data-path="md-observables.html"><a href="md-observables.html#connection-to-experiment"><i class="fa fa-check"></i><b>8.10</b> Connection to experiment</a></li>
<li class="chapter" data-level="8.11" data-path="md-observables.html"><a href="md-observables.html#the-computationalexperimental-loop"><i class="fa fa-check"></i><b>8.11</b> The computational–experimental loop</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-iii-configurational-disorder.html"><a href="part-iii-configurational-disorder.html"><i class="fa fa-check"></i>Part III: Configurational Disorder</a></li>
<li class="chapter" data-level="9" data-path="monte-carlo-sampling.html"><a href="monte-carlo-sampling.html"><i class="fa fa-check"></i><b>9</b> Monte Carlo sampling</a>
<ul>
<li class="chapter" data-level="9.1" data-path="monte-carlo-sampling.html"><a href="monte-carlo-sampling.html#beyond-molecular-dynamics"><i class="fa fa-check"></i><b>9.1</b> Beyond molecular dynamics</a></li>
<li class="chapter" data-level="9.2" data-path="monte-carlo-sampling.html"><a href="monte-carlo-sampling.html#the-goal-ensemble-averages"><i class="fa fa-check"></i><b>9.2</b> The goal: ensemble averages</a></li>
<li class="chapter" data-level="9.3" data-path="monte-carlo-sampling.html"><a href="monte-carlo-sampling.html#why-not-sample-uniformly"><i class="fa fa-check"></i><b>9.3</b> Why not sample uniformly?</a></li>
<li class="chapter" data-level="9.4" data-path="monte-carlo-sampling.html"><a href="monte-carlo-sampling.html#markov-chain-monte-carlo"><i class="fa fa-check"></i><b>9.4</b> Markov chain Monte Carlo</a></li>
<li class="chapter" data-level="9.5" data-path="monte-carlo-sampling.html"><a href="monte-carlo-sampling.html#the-metropolis-algorithm"><i class="fa fa-check"></i><b>9.5</b> The Metropolis algorithm</a></li>
<li class="chapter" data-level="9.6" data-path="monte-carlo-sampling.html"><a href="monte-carlo-sampling.html#what-you-get-2"><i class="fa fa-check"></i><b>9.6</b> What you get</a></li>
<li class="chapter" data-level="9.7" data-path="monte-carlo-sampling.html"><a href="monte-carlo-sampling.html#what-you-dont-get"><i class="fa fa-check"></i><b>9.7</b> What you don’t get</a></li>
<li class="chapter" data-level="9.8" data-path="monte-carlo-sampling.html"><a href="monte-carlo-sampling.html#neutron-connection"><i class="fa fa-check"></i><b>9.8</b> Neutron connection</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="cluster-expansion.html"><a href="cluster-expansion.html"><i class="fa fa-check"></i><b>10</b> Cluster expansion</a>
<ul>
<li class="chapter" data-level="10.1" data-path="cluster-expansion.html"><a href="cluster-expansion.html#the-problem"><i class="fa fa-check"></i><b>10.1</b> The problem</a></li>
<li class="chapter" data-level="10.2" data-path="cluster-expansion.html"><a href="cluster-expansion.html#the-idea"><i class="fa fa-check"></i><b>10.2</b> The idea</a></li>
<li class="chapter" data-level="10.3" data-path="cluster-expansion.html"><a href="cluster-expansion.html#symmetry-and-truncation"><i class="fa fa-check"></i><b>10.3</b> Symmetry and truncation</a></li>
<li class="chapter" data-level="10.4" data-path="cluster-expansion.html"><a href="cluster-expansion.html#fitting-the-expansion"><i class="fa fa-check"></i><b>10.4</b> Fitting the expansion</a></li>
<li class="chapter" data-level="10.5" data-path="cluster-expansion.html"><a href="cluster-expansion.html#what-you-get-3"><i class="fa fa-check"></i><b>10.5</b> What you get</a></li>
<li class="chapter" data-level="10.6" data-path="cluster-expansion.html"><a href="cluster-expansion.html#limitations-1"><i class="fa fa-check"></i><b>10.6</b> Limitations</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="short-range-order-and-pdf.html"><a href="short-range-order-and-pdf.html"><i class="fa fa-check"></i><b>11</b> Short-range order and PDF</a>
<ul>
<li class="chapter" data-level="11.1" data-path="short-range-order-and-pdf.html"><a href="short-range-order-and-pdf.html#long-range-order-vs-short-range-order"><i class="fa fa-check"></i><b>11.1</b> Long-range order vs short-range order</a></li>
<li class="chapter" data-level="11.2" data-path="short-range-order-and-pdf.html"><a href="short-range-order-and-pdf.html#what-bragg-diffraction-misses"><i class="fa fa-check"></i><b>11.2</b> What Bragg diffraction misses</a></li>
<li class="chapter" data-level="11.3" data-path="short-range-order-and-pdf.html"><a href="short-range-order-and-pdf.html#pdf-captures-local-structure"><i class="fa fa-check"></i><b>11.3</b> PDF captures local structure</a></li>
<li class="chapter" data-level="11.4" data-path="short-range-order-and-pdf.html"><a href="short-range-order-and-pdf.html#the-computational-approach"><i class="fa fa-check"></i><b>11.4</b> The computational approach</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="case-study-short-range-order-in-li2feso.html"><a href="case-study-short-range-order-in-li2feso.html"><i class="fa fa-check"></i><b>12</b> Case study: short-range order in Li<sub>2</sub>FeSO</a>
<ul>
<li class="chapter" data-level="12.1" data-path="case-study-short-range-order-in-li2feso.html"><a href="case-study-short-range-order-in-li2feso.html#the-puzzle"><i class="fa fa-check"></i><b>12.1</b> The puzzle</a></li>
<li class="chapter" data-level="12.2" data-path="case-study-short-range-order-in-li2feso.html"><a href="case-study-short-range-order-in-li2feso.html#the-computational-approach-1"><i class="fa fa-check"></i><b>12.2</b> The computational approach</a></li>
<li class="chapter" data-level="12.3" data-path="case-study-short-range-order-in-li2feso.html"><a href="case-study-short-range-order-in-li2feso.html#the-result-preferential-short-range-order"><i class="fa fa-check"></i><b>12.3</b> The result: preferential short-range order</a></li>
<li class="chapter" data-level="12.4" data-path="case-study-short-range-order-in-li2feso.html"><a href="case-study-short-range-order-in-li2feso.html#validation-against-experiment"><i class="fa fa-check"></i><b>12.4</b> Validation against experiment</a></li>
<li class="chapter" data-level="12.5" data-path="case-study-short-range-order-in-li2feso.html"><a href="case-study-short-range-order-in-li2feso.html#the-physical-origin-anion-polarisation"><i class="fa fa-check"></i><b>12.5</b> The physical origin: anion polarisation</a></li>
<li class="chapter" data-level="12.6" data-path="case-study-short-range-order-in-li2feso.html"><a href="case-study-short-range-order-in-li2feso.html#what-this-example-illustrates"><i class="fa fa-check"></i><b>12.6</b> What this example illustrates</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i>Conclusion</a>
<ul>
<li class="chapter" data-level="12.7" data-path="conclusion.html"><a href="conclusion.html#four-themes"><i class="fa fa-check"></i><b>12.7</b> Four themes</a></li>
<li class="chapter" data-level="12.8" data-path="conclusion.html"><a href="conclusion.html#what-now"><i class="fa fa-check"></i><b>12.8</b> What now?</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="appendix-dynamical-matrix.html"><a href="appendix-dynamical-matrix.html"><i class="fa fa-check"></i><b>A</b> Derivation of the dynamical matrix for periodic systems</a>
<ul>
<li class="chapter" data-level="A.1" data-path="appendix-dynamical-matrix.html"><a href="appendix-dynamical-matrix.html#setup-and-notation"><i class="fa fa-check"></i><b>A.1</b> Setup and notation</a></li>
<li class="chapter" data-level="A.2" data-path="appendix-dynamical-matrix.html"><a href="appendix-dynamical-matrix.html#translational-symmetry"><i class="fa fa-check"></i><b>A.2</b> Translational symmetry</a></li>
<li class="chapter" data-level="A.3" data-path="appendix-dynamical-matrix.html"><a href="appendix-dynamical-matrix.html#plane-wave-ansatz"><i class="fa fa-check"></i><b>A.3</b> Plane-wave ansatz</a></li>
<li class="chapter" data-level="A.4" data-path="appendix-dynamical-matrix.html"><a href="appendix-dynamical-matrix.html#substitution-into-equations-of-motion"><i class="fa fa-check"></i><b>A.4</b> Substitution into equations of motion</a></li>
<li class="chapter" data-level="A.5" data-path="appendix-dynamical-matrix.html"><a href="appendix-dynamical-matrix.html#the-dynamical-matrix"><i class="fa fa-check"></i><b>A.5</b> The dynamical matrix</a></li>
<li class="chapter" data-level="A.6" data-path="appendix-dynamical-matrix.html"><a href="appendix-dynamical-matrix.html#the-final-result"><i class="fa fa-check"></i><b>A.6</b> The final result</a></li>
<li class="chapter" data-level="A.7" data-path="appendix-dynamical-matrix.html"><a href="appendix-dynamical-matrix.html#connection-to-experiment-1"><i class="fa fa-check"></i><b>A.7</b> Connection to experiment</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Computational Techniques for Sustainable Energy Materials</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="md-observables" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">8</span> Molecular dynamics: observables and neutron connections<a href="md-observables.html#md-observables" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="from-trajectories-to-observables" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> From trajectories to observables<a href="md-observables.html#from-trajectories-to-observables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A molecular dynamics trajectory is a sequence of atomic configurations over time — positions and velocities at each timestep. This raw data must be processed to extract physically meaningful quantities. Some quantities involve simple averages: where are atoms on average, and how are they distributed in space? Others probe dynamics: how do properties change over time, and how quickly does the system lose memory of its initial state?</p>
</div>
<div id="ensemble-averaged-structure" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Ensemble-averaged structure<a href="md-observables.html#ensemble-averaged-structure" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Neutron diffraction measures a time-averaged structure. Atoms vibrate; the measured positions are averages over that motion. At higher temperatures, the amplitude of vibration increases, and for some systems atoms may sample multiple local configurations.</p>
<p>MD naturally provides this ensemble average. The time-averaged atomic positions from a trajectory correspond to what diffraction measures — both average over the thermal motion of atoms. For an ordered crystal, this gives thermally-expanded lattice parameters and anisotropic displacement parameters that can be compared directly with Rietveld refinement.</p>
<p>For disordered systems, the comparison is more subtle. Bragg diffraction reports the average structure, which may not correspond to any single instantaneous configuration. If atoms locally displace from high-symmetry positions but do so differently in different unit cells, diffraction sees only the average. The MD trajectory contains the full distribution of local configurations — information that goes beyond what Bragg diffraction can access.</p>
</div>
<div id="pair-distribution-functions" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Pair distribution functions<a href="md-observables.html#pair-distribution-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The pair distribution function <span class="math inline">\(g(r)\)</span> measures the probability of finding an atom at distance <span class="math inline">\(r\)</span> from another atom, relative to a uniform distribution. Peaks in <span class="math inline">\(g(r)\)</span> appear at characteristic neighbour distances: the first peak corresponds to nearest neighbours, the second to next-nearest neighbours, and so on. The function encodes spatial correlations — how the presence of one atom affects where others are likely to be found.</p>
<p>Experimentally, <span class="math inline">\(g(r)\)</span> comes from total scattering measurements. The Fourier transform of the structure factor <span class="math inline">\(S(Q)\)</span> gives the PDF directly. This is sensitive to local structure in ways that Bragg diffraction is not — disorder, distortions, and short-range correlations all appear in the PDF.</p>
<p>From an MD trajectory, <span class="math inline">\(g(r)\)</span> is computed by histogramming interatomic distances across all configurations:</p>
<p><span class="math display">\[g(r) = \frac{V}{4\pi r^2 N^2} \left\langle \sum_{i \neq j} \delta(r - |\mathbf{r}_i - \mathbf{r}_j|) \right\rangle\]</span></p>
<p>The average is over trajectory frames. In practice, distances are binned into shells of width <span class="math inline">\(\delta r\)</span> and normalised appropriately.</p>
<p>This provides a direct comparison between simulation and experiment. If the simulated <span class="math inline">\(g(r)\)</span> matches the measured PDF, the simulation captures the local structure correctly. Disagreement points to problems — perhaps with the <span class="math inline">\(E(\mathbf{r})\)</span> method, perhaps with the structural model, perhaps with the sample itself.</p>
<p>For systems with multiple atom types, partial pair distribution functions <span class="math inline">\(g_{\alpha\beta}(r)\)</span> separate contributions from different pair types: Li–Li, Li–O, O–O, and so on. Simulation provides these automatically. Experimentally, isotope substitution or anomalous X-ray scattering can separate them, though this is more challenging. The partials reveal which correlations are responsible for features in the total <span class="math inline">\(g(r)\)</span> — information that aids interpretation of complex structures.</p>
</div>
<div id="dynamics-and-the-dynamic-structure-factor" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> Dynamics and the dynamic structure factor<a href="md-observables.html#dynamics-and-the-dynamic-structure-factor" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The quantities above are static — averages over the trajectory with no reference to how the system evolves in time. But MD also captures dynamics: how properties change, how quickly correlations decay, how the system moves from one configuration to another.</p>
<p>For dynamics, the key experimental observable is the dynamic structure factor <span class="math inline">\(S(\mathbf{Q}, \omega)\)</span>, measured by inelastic neutron scattering. At higher energy transfers, <span class="math inline">\(S(\mathbf{Q}, \omega)\)</span> captures vibrational excitations — phonons. Near the elastic line, small energy transfers reveal diffusive motion and relaxation processes; this is the quasielastic regime. Several routes connect MD trajectories to <span class="math inline">\(S(\mathbf{Q}, \omega)\)</span>: velocity autocorrelation functions for vibrations, mean squared displacements for diffusion coefficients, and Van Hove correlation functions for the full space-time picture.</p>
</div>
<div id="time-correlation-functions" class="section level2 hasAnchor" number="8.5">
<h2><span class="header-section-number">8.5</span> Time correlation functions<a href="md-observables.html#time-correlation-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Many dynamical quantities take the form of time correlation functions. The idea is simple: how does some property at time <span class="math inline">\(t\)</span> relate to the same property at time 0? If a property fluctuates randomly, it will quickly become uncorrelated with its initial value. If it changes slowly or oscillates, correlations persist.</p>
<p>The general form is:</p>
<p><span class="math display">\[C_{AB}(t) = \langle A(0) B(t) \rangle\]</span></p>
<p>where <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are dynamical variables and the angle brackets denote an average over time origins. In practice, this is computed by averaging over many starting points along the trajectory:</p>
<p><span class="math display">\[C_{AB}(t) = \frac{1}{T-t} \int_0^{T-t} A(t&#39;) B(t&#39; + t) \, \mathrm{d}t&#39;\]</span></p>
<p>where <span class="math inline">\(T\)</span> is the total trajectory length. Different choices of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> give different physical information.</p>
</div>
<div id="vibrational-density-of-states" class="section level2 hasAnchor" number="8.6">
<h2><span class="header-section-number">8.6</span> Vibrational density of states<a href="md-observables.html#vibrational-density-of-states" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For harmonic systems, the vibrational density of states comes from diagonalising the dynamical matrix, as described in Chapter <a href="phonons.html#phonons">6</a>. MD provides an alternative that does not assume harmonicity.</p>
<p>The velocity autocorrelation function measures how atomic velocities correlate with themselves at later times:</p>
<p><span class="math display">\[C_{vv}(t) = \langle \mathbf{v}(0) \cdot \mathbf{v}(t) \rangle\]</span></p>
<p>At <span class="math inline">\(t = 0\)</span>, this equals <span class="math inline">\(\langle v^2 \rangle\)</span>, proportional to the temperature. As time increases, velocities lose correlation with their initial values — collisions and interactions randomise them. The rate at which this happens, and any oscillations along the way, encode information about the vibrational motion.</p>
<p>The Fourier transform of the velocity autocorrelation function gives the vibrational density of states:</p>
<p><span class="math display">\[g(\omega) = \int_{-\infty}^{\infty} C_{vv}(t) \, \mathrm{e}^{-\mathrm{i}\omega t} \, \mathrm{d}t\]</span></p>
<p>This works because oscillatory motion at frequency <span class="math inline">\(\omega\)</span> contributes oscillations at that frequency to the velocity autocorrelation function, which appear as a peak at <span class="math inline">\(\omega\)</span> in the Fourier transform.</p>
<p>The result includes all anharmonic effects — the atoms move on the full potential energy surface, not a quadratic approximation to it. For strongly anharmonic systems, the MD-derived density of states may differ substantially from harmonic phonon calculations. Comparison with the high-energy-transfer region of <span class="math inline">\(S(\mathbf{Q}, \omega)\)</span> from INS then tests whether the simulation captures the real anharmonicity.</p>
<p>For systems with multiple atom types, partial densities of states can be computed by restricting the velocity autocorrelation to specific species — lithium vibrations, oxygen vibrations, and so on. Simulation provides these decompositions directly. Experimentally, separating contributions is harder, though isotope substitution can help: replacing hydrogen with deuterium shifts the frequencies associated with those atoms, allowing their contribution to be identified. The partials reveal which species are responsible for features in the total spectrum — a peak at a particular frequency might come from light, fast-moving lithium ions or from heavier framework atoms, and the decomposition tells you which.</p>
</div>
<div id="diffusion-and-mean-squared-displacement" class="section level2 hasAnchor" number="8.7">
<h2><span class="header-section-number">8.7</span> Diffusion and mean squared displacement<a href="md-observables.html#diffusion-and-mean-squared-displacement" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Many energy materials involve ionic transport — lithium in batteries, protons in fuel cells, oxygen in solid oxide cells. MD simulates this transport directly.</p>
<p>The mean squared displacement (MSD) measures how far atoms move from their initial positions:</p>
<p><span class="math display">\[\text{MSD}(t) = \langle |\mathbf{r}(t) - \mathbf{r}(0)|^2 \rangle\]</span></p>
<p>where the average is over all atoms of the species of interest and over time origins.</p>
<p>For atoms vibrating around fixed sites, the MSD oscillates and remains bounded — atoms jiggle but do not go anywhere on average. For diffusing species, the MSD grows with time. At long times, diffusive motion gives:</p>
<p><span class="math display">\[\text{MSD}(t) \rightarrow 6D^*t\]</span></p>
<p>where <span class="math inline">\(D^*\)</span> is the self-diffusion coefficient and the factor of 6 comes from three-dimensional motion (2 for each dimension). Plotting MSD against time and fitting the slope gives <span class="math inline">\(D^*\)</span> directly.</p>
<p>This can be decomposed by species. In a lithium-ion conductor, lithium motion (which should show diffusion) can be tracked separately from the framework atoms (which should show only vibration). The simulation reveals not just that diffusion occurs, but which atoms are mobile and which are not.</p>
</div>
<div id="mechanistic-insight-from-trajectories" class="section level2 hasAnchor" number="8.8">
<h2><span class="header-section-number">8.8</span> Mechanistic insight from trajectories<a href="md-observables.html#mechanistic-insight-from-trajectories" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The trajectory contains more than just a diffusion coefficient. Every atomic position at every timestep is recorded — in principle, the complete mechanistic picture is there. For simple diffusion mechanisms, this can be extracted directly by tracking individual atoms through the trajectory. Does a lithium ion hop between discrete sites, or does it follow a continuous path? Does it wait at one site for a long time then jump quickly, or does it move gradually? Are jumps correlated — does one ion moving trigger another to move? These questions can be answered by visualising trajectories and by statistical analysis of jump events.</p>
<p>For more complex mechanisms, the analysis becomes harder. If many atoms move cooperatively, or if the motion involves subtle rearrangements of the surrounding structure, identifying what is happening requires more sophisticated analysis. But the information is present in the trajectory — the challenge is extracting it.</p>
<p>This mechanistic insight can also inform experimental analysis. Quasielastic scattering data are typically fitted to models — jump diffusion, continuous diffusion, confined motion — but the choice of model is often unclear from the scattering data alone. If trajectory analysis shows that lithium ions hop between discrete sites with a well-defined residence time, this justifies using a jump diffusion model. Computation provides the mechanistic picture; experiment tests whether that picture is consistent with the measured scattering.</p>
</div>
<div id="the-van-hove-correlation-function" class="section level2 hasAnchor" number="8.9">
<h2><span class="header-section-number">8.9</span> The Van Hove correlation function<a href="md-observables.html#the-van-hove-correlation-function" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The quantities discussed so far either capture spatial information (<span class="math inline">\(g(r)\)</span>) or temporal information (velocity autocorrelation, MSD). The Van Hove correlation function combines both, measuring spatial correlations as a function of time — and its Fourier transform connects directly to the <span class="math inline">\(S(\mathbf{Q}, \omega)\)</span> that neutron scattering measures.</p>
<p>The <strong>self part</strong> <span class="math inline">\(G_s(\mathbf{r}, t)\)</span> asks: given that an atom was at some position at time 0, what is the probability of finding <em>that same atom</em> at displacement <span class="math inline">\(\mathbf{r}\)</span> from its initial position after time <span class="math inline">\(t\)</span>?</p>
<p><span class="math display">\[G_s(\mathbf{r}, t) = \frac{1}{N} \left\langle \sum_i \delta(\mathbf{r} - [\mathbf{r}_i(t) - \mathbf{r}_i(0)]) \right\rangle\]</span></p>
<p>At <span class="math inline">\(t = 0\)</span>, this is a delta function at the origin — each atom is where it started. As time evolves, <span class="math inline">\(G_s(\mathbf{r}, t)\)</span> broadens as atoms move. For vibrating atoms, it broadens but remains centred near the origin. For diffusing atoms, the distribution spreads and the width grows with time.</p>
<p>The <strong>distinct part</strong> <span class="math inline">\(G_d(\mathbf{r}, t)\)</span> asks a different question: given that atom <span class="math inline">\(i\)</span> was at some position at time 0, what is the probability of finding a <em>different</em> atom <span class="math inline">\(j\)</span> at distance <span class="math inline">\(\mathbf{r}\)</span> from that initial position after time <span class="math inline">\(t\)</span>?</p>
<p><span class="math display">\[G_d(\mathbf{r}, t) = \frac{1}{N} \left\langle \sum_{i \neq j} \delta(\mathbf{r} - [\mathbf{r}_j(t) - \mathbf{r}_i(0)]) \right\rangle\]</span></p>
<p>At <span class="math inline">\(t = 0\)</span>, this is the pair distribution function <span class="math inline">\(g(r) - 1\)</span>: peaks at the neighbour distances, reflecting the local structure around each atom. As time evolves, <span class="math inline">\(G_d(\mathbf{r}, t)\)</span> reveals how this local structure changes. In a solid, the peaks persist — neighbours vibrate but remain in place. In a liquid, the peaks decay as neighbours diffuse away and are replaced by other atoms. The timescale over which correlations decay characterises structural relaxation.</p>
<p>For a diffusing species in a solid framework, the behaviour is intermediate. The mobile ions lose their initial correlations as they hop between sites, while the framework atoms maintain theirs. The distinct part thus probes collective behaviour: not just where one atom goes, but how the arrangement of atoms evolves.</p>
</div>
<div id="connection-to-experiment" class="section level2 hasAnchor" number="8.10">
<h2><span class="header-section-number">8.10</span> Connection to experiment<a href="md-observables.html#connection-to-experiment" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Van Hove functions connect to <span class="math inline">\(S(\mathbf{Q}, \omega)\)</span> through a space-time Fourier transform:</p>
<p><span class="math display">\[S(\mathbf{Q}, \omega) = \int \int G(\mathbf{r}, t) \, \mathrm{e}^{\mathrm{i}(\mathbf{Q} \cdot \mathbf{r} - \omega t)} \, \mathrm{d}\mathbf{r} \, \mathrm{d}t\]</span></p>
<p>The self and distinct parts contribute differently to the measured scattering. For nuclei with large incoherent scattering cross-sections — hydrogen being the prime example — the scattering is dominated by the self part, reflecting single-particle motion. For coherent scatterers, the distinct part contributes, and the scattering reflects collective dynamics and structural correlations.</p>
<p>MD provides <span class="math inline">\(G(\mathbf{r}, t)\)</span> directly — a real-space, real-time picture. The Fourier transform to <span class="math inline">\(S(\mathbf{Q}, \omega)\)</span> then allows comparison with experiment: does the simulation reproduce the measured scattering? If it does, the mechanistic picture extracted from trajectory analysis is consistent with what the neutrons see.</p>
</div>
<div id="the-computationalexperimental-loop" class="section level2 hasAnchor" number="8.11">
<h2><span class="header-section-number">8.11</span> The computational–experimental loop<a href="md-observables.html#the-computationalexperimental-loop" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The connection between MD and neutron scattering runs both ways.</p>
<p>Computation provides microscopic detail. From trajectories, we see how atoms move — mechanisms are visible directly. Calculating <span class="math inline">\(S(\mathbf{Q}, \omega)\)</span> from the simulation then allows comparison with experiment. Agreement means the microscopic picture from simulation is consistent with the measured dynamics.</p>
<p>Disagreement raises questions. The <span class="math inline">\(E(\mathbf{r})\)</span> method may be inadequate — the potential may not capture the relevant physics. But simulations typically model idealised structures: perfect stoichiometry, no impurities, no grain boundaries, infinite crystals via periodic boundary conditions. Real samples have defects, secondary phases, surface effects, non-stoichiometry. Disagreement might mean the simulation is wrong, or it might mean the sample differs from its idealised description. Computation can reveal what ideal behaviour should look like, highlighting where real samples deviate.</p>
<p>Experiment provides constraints and raises questions. Unexpected quasielastic broadening, a lineshape that does not fit standard models, dynamics that differ from predictions — these prompt computational investigation. What mechanism would produce this scattering? The most productive work often involves iteration: measurement raises a question, simulation proposes an answer, comparison tests the proposal.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="molecular-dynamics-principles.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="part-iii-configurational-disorder.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/bjmorgan/neutrons_for_sustainable_energy/main/chapters/md_observables.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section"
  },
  "mathjax": {
    "extensions": "mhchem.js"
  },
  "mathjax_config": {
    "TeX": {
      "Macros": {
        "conc": [
          "[\mathrm{#1}]",
          1
        ],
        "diffc": [
          "\frac{\mathrm{d}\conc{#1}}{\mathrm{d}t}",
          1
        ]
      }
    }
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
